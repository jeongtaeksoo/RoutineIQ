[2026-02-16 00:31:00] CTO batch runner started
[2026-02-16 00:31:00] Context file: /Users/taeksoojung/Desktop/RUTINEIQ_CONTEXT.md
[2026-02-16 00:31:00] Doc file: /Users/taeksoojung/Desktop/RutineIQ/docs/CTO_AUTONOMOUS_RUN.md
[2026-02-16 00:31:00] Stdout log: /Users/taeksoojung/Desktop/RutineIQ/logs/cto_autonomous/stdout_20260216_003100.log
[2026-02-16 00:31:00] Meta file: /Users/taeksoojung/Desktop/RutineIQ/logs/cto_autonomous/run_20260216_003100.meta
[2026-02-16 00:31:00] Cycle range: 1-100
[2026-02-16 00:31:00] === Batch 1/10 (Cycle 1-10) ===
[2026-02-16 00:31:00] --- Cycle 1 start ---
[2026-02-16 00:31:00] Cycle 1 attempt 1
[2026-02-16 00:31:00] RUN [api-pytest] cd /Users/taeksoojung/Desktop/RutineIQ/apps/api && .venv/bin/python -m pytest tests/ -v --tb=short
============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-8.3.4, pluggy-1.6.0 -- /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/taeksoojung/Desktop/RutineIQ/apps/api
configfile: pytest.ini
plugins: anyio-4.12.1, respx-0.22.0, asyncio-0.25.2
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=function
collecting ... collected 176 items

tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_01] PASSED [  0%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_02] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_03] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_04] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_05] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_01] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_02] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_03] PASSED [  4%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_04] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_05] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_01] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_02] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_03] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_04] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_05] PASSED [  8%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_01] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_02] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_03] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_04] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_05] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_01] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_02] PASSED [ 12%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_03] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_04] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_05] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_01] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_02] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_03] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_04] PASSED [ 16%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_05] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[worker_ko-ko-entries0-False-3-True] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[student_en-en-entries1-False-3-False] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[low_activity-ko-entries2-False-1-True] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[day2_with_yesterday_plan-ko-entries3-True-2-True] PASSED [ 19%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[high_activity-en-entries4-False-4-False] PASSED [ 19%]
tests/test_analyze_route.py::test_analyze_success_returns_report PASSED  [ 20%]
tests/test_analyze_route.py::test_analyze_returns_429_on_rate_limit PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_openai_failure_returns_502 PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_requires_auth PASSED           [ 22%]
tests/test_analyze_route.py::test_analyze_allows_first_run_with_incomplete_profile PASSED [ 22%]
tests/test_analyze_route.py::test_analyze_tracks_schema_retry_in_quality_meta PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_signal_rich_quality_score_is_higher_than_signal_poor PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_low_signal_data_adds_conservative_guidance PASSED [ 24%]
tests/test_e2e_flows.py::test_new_user_full_flow_save_parse_save_analyze_report PASSED [ 25%]
tests/test_e2e_flows.py::test_returning_user_flow_reuses_cached_report PASSED [ 25%]
tests/test_e2e_flows.py::test_preferences_and_cohort_flow_uses_updated_profile_filters PASSED [ 26%]
tests/test_e2e_flows.py::test_multi_day_trend_flow_posts_7_days_and_returns_weekly_insights PASSED [ 26%]
tests/test_error_cases.py::test_parse_diary_empty_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_parse_diary_too_long_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_analyze_with_future_date_is_handled PASSED [ 28%]
tests/test_error_cases.py::test_analyze_with_old_date_is_handled PASSED  [ 28%]
tests/test_error_cases.py::test_parse_diary_malformed_openai_output_returns_502 PASSED [ 29%]
tests/test_error_cases.py::test_reflect_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_suggest_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_analyze_malformed_openai_output_returns_502 PASSED [ 31%]
tests/test_error_cases.py::test_analyze_supabase_select_failure_returns_502_or_500 PASSED [ 31%]
tests/test_error_cases.py::test_reflect_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_suggest_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_analyze_missing_activity_log_still_returns_report PASSED [ 33%]
tests/test_error_cases.py::test_rate_limit_isolated_between_two_users PASSED [ 34%]
tests/test_health.py::test_health_returns_ok PASSED                      [ 34%]
tests/test_insights_route.py::test_weekly_insights_includes_streak_and_trend PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_resets_current_streak_when_today_missing PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_rejects_date_window_over_31_days PASSED [ 36%]
tests/test_logs_route.py::test_post_logs_creates_entry PASSED            [ 36%]
tests/test_logs_route.py::test_post_logs_duplicate_date_uses_upsert_on_conflict PASSED [ 37%]
tests/test_logs_route.py::test_get_logs_returns_saved_log PASSED         [ 38%]
tests/test_logs_route.py::test_logs_requires_auth PASSED                 [ 38%]
tests/test_logs_route.py::test_post_logs_updates_profile_streak_metrics PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_ignores_missing_streak_columns_until_migration_applied PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_persists_optional_daily_meta PASSED [ 40%]
tests/test_logs_route.py::test_post_logs_accepts_optional_entry_confidence PASSED [ 40%]
tests/test_openai_service.py::test_openai_service_parses_valid_response PASSED [ 41%]
tests/test_openai_service.py::test_openai_service_raises_on_invalid_json_output PASSED [ 42%]
tests/test_openai_service.py::test_openai_service_retries_then_succeeds PASSED [ 42%]
tests/test_parse.py::test_parse_diary_success PASSED                     [ 43%]
tests/test_parse.py::test_parse_diary_rejects_short_text PASSED          [ 43%]
tests/test_parse.py::test_parse_diary_request_schema_validation PASSED   [ 44%]
tests/test_parse.py::test_parse_diary_requires_auth PASSED               [ 44%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_01] PASSED [ 45%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_02] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_03] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_04] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_05] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_01] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_02] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_03] PASSED [ 49%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_04] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_05] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_01] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_02] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_03] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_04] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_05] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_01] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_02] PASSED [ 54%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_03] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_04] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_05] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_01] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_02] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_03] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_04] PASSED [ 58%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_05] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_01] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_02] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_03] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_04] PASSED [ 61%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_05] PASSED [ 61%]
tests/test_preferences_route.py::test_get_profile_returns_profile_with_job_family PASSED [ 62%]
tests/test_preferences_route.py::test_put_profile_updates_and_returns_profile PASSED [ 63%]
tests/test_preferences_route.py::test_put_profile_invalid_job_family_returns_422 PASSED [ 63%]
tests/test_preferences_route.py::test_delete_data_returns_ok_and_calls_supabase_delete PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[get-/api/preferences/profile-None] PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[put-/api/preferences/profile-payload1] PASSED [ 65%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[delete-/api/preferences/data-None] PASSED [ 65%]
tests/test_preferences_route.py::test_put_profile_deduplicates_trend_compare_by PASSED [ 66%]
tests/test_preferences_route.py::test_put_profile_falls_back_to_service_role_on_rls_error PASSED [ 67%]
tests/test_preferences_route.py::test_put_profile_returns_500_when_upsert_returns_empty_row PASSED [ 67%]
tests/test_reflect_route.py::test_reflect_happy_path_returns_question PASSED [ 68%]
tests/test_reflect_route.py::test_reflect_requires_auth PASSED           [ 68%]
tests/test_reflect_route.py::test_reflect_returns_429_when_daily_limit_exceeded PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_openai_failure_returns_502 PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_handles_empty_entries_gracefully PASSED [ 70%]
tests/test_reflect_route.py::test_reflect_rejects_missing_entries_field PASSED [ 71%]
tests/test_reflect_route.py::test_reflect_rejects_invalid_entries_type PASSED [ 71%]
tests/test_reports_route.py::test_reports_returns_existing_report PASSED [ 72%]
tests/test_reports_route.py::test_reports_returns_404_when_missing PASSED [ 72%]
tests/test_reports_route.py::test_reports_requires_auth PASSED           [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/logs-payload0] PASSED [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[get-/api/reports?date=2026-02-15-None] PASSED [ 74%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/analyze-payload2] PASSED [ 75%]
tests/test_security.py::test_expired_jwt_returns_401 PASSED              [ 75%]
tests/test_security.py::test_tampered_jwt_returns_401 PASSED             [ 76%]
tests/test_security.py::test_logs_get_scopes_queries_to_authenticated_user PASSED [ 76%]
tests/test_security.py::test_logs_post_forces_user_id_from_auth_context PASSED [ 77%]
tests/test_security.py::test_reports_get_scopes_queries_to_authenticated_user PASSED [ 77%]
tests/test_security.py::test_insights_weekly_scopes_queries_to_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_profile_get_scopes_by_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_delete_scopes_by_authenticated_user PASSED [ 79%]
tests/test_security.py::test_preferences_delete_removes_only_my_rows PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400 PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_replay_is_ignored PASSED     [ 81%]
tests/test_streaks_service.py::test_compute_streaks_returns_five_for_five_consecutive_days PASSED [ 81%]
tests/test_streaks_service.py::test_compute_streaks_resets_current_when_anchor_day_missing PASSED [ 82%]
tests/test_streaks_service.py::test_extract_log_dates_ignores_invalid_rows PASSED [ 82%]
tests/test_stripe_integration.py::test_stripe_status_returns_availability PASSED [ 83%]
tests/test_stripe_integration.py::test_stripe_status_requires_auth PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_happy_path PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_auth PASSED [ 85%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_email_identity PASSED [ 85%]
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription PASSED [ 86%]
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade PASSED [ 86%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature PASSED [ 87%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature PASSED [ 88%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature PASSED [ 88%]
tests/test_suggest_route.py::test_suggest_happy_path_returns_activity PASSED [ 89%]
tests/test_suggest_route.py::test_suggest_requires_auth PASSED           [ 89%]
tests/test_suggest_route.py::test_suggest_returns_429_when_daily_limit_exceeded PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_openai_failure_returns_502 PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_rejects_missing_required_fields PASSED [ 91%]
tests/test_suggest_route.py::test_suggest_accepts_null_context PASSED    [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_non_string_current_time PASSED [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_invalid_time_format PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_extracts_supabase_payload PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_uses_text_when_json_missing PASSED [ 94%]
tests/test_supabase_rest_service.py::test_select_wraps_single_object_as_list PASSED [ 94%]
tests/test_trends_route.py::test_trends_cohort_happy_path_includes_cohort_and_personal_metrics PASSED [ 95%]
tests/test_trends_route.py::test_trends_cohort_requires_auth PASSED      [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_disabled_when_opt_in_is_false PASSED [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_default_metrics_on_empty_rpc PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_unknown_query_params_do_not_break_response PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_uses_profile_filters_in_rpc_call PASSED [ 98%]
tests/test_usage_service.py::test_estimate_cost_usd_returns_value PASSED [ 98%]
tests/test_usage_service.py::test_count_daily_analyze_calls_counts_rows PASSED [ 99%]
tests/test_usage_service.py::test_insert_usage_event_fallbacks_when_service_conflict PASSED [100%]

=============================== warnings summary ===============================
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature
  /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/lib/python3.12/site-packages/httpx/_content.py:204: DeprecationWarning: Use 'content=<...>' to upload raw bytes/text content.
    warnings.warn(message, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 176 passed, 8 warnings in 1.77s ========================
[2026-02-16 00:31:02] PASS [api-pytest]
[2026-02-16 00:31:02] RUN [web-lint] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run lint

> lint
> next lint

âœ” No ESLint warnings or errors
[2026-02-16 00:31:04] PASS [web-lint]
[2026-02-16 00:31:04] RUN [web-typecheck] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run typecheck

> typecheck
> tsc --noEmit --incremental false

[2026-02-16 00:31:06] PASS [web-typecheck]
[2026-02-16 00:31:06] RUN [web-build] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run build

> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand

[2026-02-16 00:31:15] PASS [web-build]
[2026-02-16 00:31:15] RUN [web-e2e] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run test:e2e

> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.4s)
  âœ“  4 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.7s)
  âœ“  3 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.9s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (631ms)
  âœ“  2 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (2.1s)
  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (2.2s)

  6 passed (13.8s)
[2026-02-16 00:31:29] PASS [web-e2e]
[2026-02-16 00:31:29] RUN [release-verify] cd /Users/taeksoojung/Desktop/RutineIQ && ./scripts/release-verify.sh
[release-verify] G1 web checks

> lint
> next lint

âœ” No ESLint warnings or errors

> typecheck
> tsc --noEmit --incremental false


> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand


> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.2s)
  âœ“  3 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.4s)
  âœ“  2 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.4s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (482ms)
  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.8s)
  âœ“  4 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (2.1s)

  6 passed (13.0s)
[release-verify] G2 api checks
All checks passed!
All done! âœ¨ ðŸ° âœ¨
1 file would be left unchanged.
Success: no issues found in 1 source file
[release-verify] G3/G4 live smoke
[staging-smoke] stripe smoke fake mode enabled
[staging-smoke] clearing existing listeners on 8012
[staging-smoke] starting local api on 127.0.0.1:8012
[staging-smoke] live F2 e2e

> test:e2e:live
> E2E_MODE=live playwright test e2e/core-flows.spec.ts -g "F2"


Running 1 test using 1 worker

  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (27.7s)

  1 passed (38.4s)
[staging-smoke] api+db+stripe live smoke
LIVE_SMOKE_OK
[staging-smoke] PASS
[release-verify] PASS
[2026-02-16 00:33:02] PASS [release-verify]
[2026-02-16 00:33:02] --- Cycle 1 PASS ---
[2026-02-16 00:33:02] --- Cycle 2 start ---
[2026-02-16 00:33:02] Cycle 2 attempt 1
[2026-02-16 00:33:02] RUN [api-pytest] cd /Users/taeksoojung/Desktop/RutineIQ/apps/api && .venv/bin/python -m pytest tests/ -v --tb=short
============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-8.3.4, pluggy-1.6.0 -- /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/taeksoojung/Desktop/RutineIQ/apps/api
configfile: pytest.ini
plugins: anyio-4.12.1, respx-0.22.0, asyncio-0.25.2
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=function
collecting ... collected 176 items

tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_01] PASSED [  0%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_02] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_03] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_04] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_05] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_01] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_02] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_03] PASSED [  4%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_04] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_05] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_01] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_02] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_03] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_04] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_05] PASSED [  8%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_01] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_02] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_03] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_04] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_05] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_01] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_02] PASSED [ 12%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_03] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_04] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_05] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_01] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_02] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_03] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_04] PASSED [ 16%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_05] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[worker_ko-ko-entries0-False-3-True] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[student_en-en-entries1-False-3-False] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[low_activity-ko-entries2-False-1-True] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[day2_with_yesterday_plan-ko-entries3-True-2-True] PASSED [ 19%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[high_activity-en-entries4-False-4-False] PASSED [ 19%]
tests/test_analyze_route.py::test_analyze_success_returns_report PASSED  [ 20%]
tests/test_analyze_route.py::test_analyze_returns_429_on_rate_limit PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_openai_failure_returns_502 PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_requires_auth PASSED           [ 22%]
tests/test_analyze_route.py::test_analyze_allows_first_run_with_incomplete_profile PASSED [ 22%]
tests/test_analyze_route.py::test_analyze_tracks_schema_retry_in_quality_meta PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_signal_rich_quality_score_is_higher_than_signal_poor PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_low_signal_data_adds_conservative_guidance PASSED [ 24%]
tests/test_e2e_flows.py::test_new_user_full_flow_save_parse_save_analyze_report PASSED [ 25%]
tests/test_e2e_flows.py::test_returning_user_flow_reuses_cached_report PASSED [ 25%]
tests/test_e2e_flows.py::test_preferences_and_cohort_flow_uses_updated_profile_filters PASSED [ 26%]
tests/test_e2e_flows.py::test_multi_day_trend_flow_posts_7_days_and_returns_weekly_insights PASSED [ 26%]
tests/test_error_cases.py::test_parse_diary_empty_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_parse_diary_too_long_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_analyze_with_future_date_is_handled PASSED [ 28%]
tests/test_error_cases.py::test_analyze_with_old_date_is_handled PASSED  [ 28%]
tests/test_error_cases.py::test_parse_diary_malformed_openai_output_returns_502 PASSED [ 29%]
tests/test_error_cases.py::test_reflect_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_suggest_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_analyze_malformed_openai_output_returns_502 PASSED [ 31%]
tests/test_error_cases.py::test_analyze_supabase_select_failure_returns_502_or_500 PASSED [ 31%]
tests/test_error_cases.py::test_reflect_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_suggest_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_analyze_missing_activity_log_still_returns_report PASSED [ 33%]
tests/test_error_cases.py::test_rate_limit_isolated_between_two_users PASSED [ 34%]
tests/test_health.py::test_health_returns_ok PASSED                      [ 34%]
tests/test_insights_route.py::test_weekly_insights_includes_streak_and_trend PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_resets_current_streak_when_today_missing PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_rejects_date_window_over_31_days PASSED [ 36%]
tests/test_logs_route.py::test_post_logs_creates_entry PASSED            [ 36%]
tests/test_logs_route.py::test_post_logs_duplicate_date_uses_upsert_on_conflict PASSED [ 37%]
tests/test_logs_route.py::test_get_logs_returns_saved_log PASSED         [ 38%]
tests/test_logs_route.py::test_logs_requires_auth PASSED                 [ 38%]
tests/test_logs_route.py::test_post_logs_updates_profile_streak_metrics PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_ignores_missing_streak_columns_until_migration_applied PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_persists_optional_daily_meta PASSED [ 40%]
tests/test_logs_route.py::test_post_logs_accepts_optional_entry_confidence PASSED [ 40%]
tests/test_openai_service.py::test_openai_service_parses_valid_response PASSED [ 41%]
tests/test_openai_service.py::test_openai_service_raises_on_invalid_json_output PASSED [ 42%]
tests/test_openai_service.py::test_openai_service_retries_then_succeeds PASSED [ 42%]
tests/test_parse.py::test_parse_diary_success PASSED                     [ 43%]
tests/test_parse.py::test_parse_diary_rejects_short_text PASSED          [ 43%]
tests/test_parse.py::test_parse_diary_request_schema_validation PASSED   [ 44%]
tests/test_parse.py::test_parse_diary_requires_auth PASSED               [ 44%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_01] PASSED [ 45%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_02] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_03] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_04] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_05] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_01] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_02] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_03] PASSED [ 49%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_04] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_05] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_01] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_02] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_03] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_04] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_05] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_01] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_02] PASSED [ 54%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_03] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_04] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_05] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_01] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_02] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_03] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_04] PASSED [ 58%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_05] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_01] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_02] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_03] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_04] PASSED [ 61%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_05] PASSED [ 61%]
tests/test_preferences_route.py::test_get_profile_returns_profile_with_job_family PASSED [ 62%]
tests/test_preferences_route.py::test_put_profile_updates_and_returns_profile PASSED [ 63%]
tests/test_preferences_route.py::test_put_profile_invalid_job_family_returns_422 PASSED [ 63%]
tests/test_preferences_route.py::test_delete_data_returns_ok_and_calls_supabase_delete PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[get-/api/preferences/profile-None] PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[put-/api/preferences/profile-payload1] PASSED [ 65%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[delete-/api/preferences/data-None] PASSED [ 65%]
tests/test_preferences_route.py::test_put_profile_deduplicates_trend_compare_by PASSED [ 66%]
tests/test_preferences_route.py::test_put_profile_falls_back_to_service_role_on_rls_error PASSED [ 67%]
tests/test_preferences_route.py::test_put_profile_returns_500_when_upsert_returns_empty_row PASSED [ 67%]
tests/test_reflect_route.py::test_reflect_happy_path_returns_question PASSED [ 68%]
tests/test_reflect_route.py::test_reflect_requires_auth PASSED           [ 68%]
tests/test_reflect_route.py::test_reflect_returns_429_when_daily_limit_exceeded PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_openai_failure_returns_502 PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_handles_empty_entries_gracefully PASSED [ 70%]
tests/test_reflect_route.py::test_reflect_rejects_missing_entries_field PASSED [ 71%]
tests/test_reflect_route.py::test_reflect_rejects_invalid_entries_type PASSED [ 71%]
tests/test_reports_route.py::test_reports_returns_existing_report PASSED [ 72%]
tests/test_reports_route.py::test_reports_returns_404_when_missing PASSED [ 72%]
tests/test_reports_route.py::test_reports_requires_auth PASSED           [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/logs-payload0] PASSED [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[get-/api/reports?date=2026-02-15-None] PASSED [ 74%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/analyze-payload2] PASSED [ 75%]
tests/test_security.py::test_expired_jwt_returns_401 PASSED              [ 75%]
tests/test_security.py::test_tampered_jwt_returns_401 PASSED             [ 76%]
tests/test_security.py::test_logs_get_scopes_queries_to_authenticated_user PASSED [ 76%]
tests/test_security.py::test_logs_post_forces_user_id_from_auth_context PASSED [ 77%]
tests/test_security.py::test_reports_get_scopes_queries_to_authenticated_user PASSED [ 77%]
tests/test_security.py::test_insights_weekly_scopes_queries_to_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_profile_get_scopes_by_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_delete_scopes_by_authenticated_user PASSED [ 79%]
tests/test_security.py::test_preferences_delete_removes_only_my_rows PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400 PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_replay_is_ignored PASSED     [ 81%]
tests/test_streaks_service.py::test_compute_streaks_returns_five_for_five_consecutive_days PASSED [ 81%]
tests/test_streaks_service.py::test_compute_streaks_resets_current_when_anchor_day_missing PASSED [ 82%]
tests/test_streaks_service.py::test_extract_log_dates_ignores_invalid_rows PASSED [ 82%]
tests/test_stripe_integration.py::test_stripe_status_returns_availability PASSED [ 83%]
tests/test_stripe_integration.py::test_stripe_status_requires_auth PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_happy_path PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_auth PASSED [ 85%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_email_identity PASSED [ 85%]
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription PASSED [ 86%]
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade PASSED [ 86%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature PASSED [ 87%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature PASSED [ 88%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature PASSED [ 88%]
tests/test_suggest_route.py::test_suggest_happy_path_returns_activity PASSED [ 89%]
tests/test_suggest_route.py::test_suggest_requires_auth PASSED           [ 89%]
tests/test_suggest_route.py::test_suggest_returns_429_when_daily_limit_exceeded PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_openai_failure_returns_502 PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_rejects_missing_required_fields PASSED [ 91%]
tests/test_suggest_route.py::test_suggest_accepts_null_context PASSED    [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_non_string_current_time PASSED [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_invalid_time_format PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_extracts_supabase_payload PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_uses_text_when_json_missing PASSED [ 94%]
tests/test_supabase_rest_service.py::test_select_wraps_single_object_as_list PASSED [ 94%]
tests/test_trends_route.py::test_trends_cohort_happy_path_includes_cohort_and_personal_metrics PASSED [ 95%]
tests/test_trends_route.py::test_trends_cohort_requires_auth PASSED      [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_disabled_when_opt_in_is_false PASSED [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_default_metrics_on_empty_rpc PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_unknown_query_params_do_not_break_response PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_uses_profile_filters_in_rpc_call PASSED [ 98%]
tests/test_usage_service.py::test_estimate_cost_usd_returns_value PASSED [ 98%]
tests/test_usage_service.py::test_count_daily_analyze_calls_counts_rows PASSED [ 99%]
tests/test_usage_service.py::test_insert_usage_event_fallbacks_when_service_conflict PASSED [100%]

=============================== warnings summary ===============================
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature
  /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/lib/python3.12/site-packages/httpx/_content.py:204: DeprecationWarning: Use 'content=<...>' to upload raw bytes/text content.
    warnings.warn(message, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 176 passed, 8 warnings in 0.88s ========================
[2026-02-16 00:33:04] PASS [api-pytest]
[2026-02-16 00:33:04] RUN [web-lint] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run lint

> lint
> next lint

âœ” No ESLint warnings or errors
[2026-02-16 00:33:05] PASS [web-lint]
[2026-02-16 00:33:05] RUN [web-typecheck] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run typecheck

> typecheck
> tsc --noEmit --incremental false

[2026-02-16 00:33:07] PASS [web-typecheck]
[2026-02-16 00:33:07] RUN [web-build] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run build

> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand

[2026-02-16 00:33:16] PASS [web-build]
[2026-02-16 00:33:16] RUN [web-e2e] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run test:e2e

> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  4 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.1s)
  âœ“  1 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.4s)
  âœ“  2 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.4s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (543ms)
  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.8s)
  âœ“  3 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (2.0s)

  6 passed (14.1s)
[2026-02-16 00:33:30] PASS [web-e2e]
[2026-02-16 00:33:30] RUN [release-verify] cd /Users/taeksoojung/Desktop/RutineIQ && ./scripts/release-verify.sh
[release-verify] G1 web checks

> lint
> next lint

âœ” No ESLint warnings or errors

> typecheck
> tsc --noEmit --incremental false


> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand


> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  2 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.2s)
  âœ“  3 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (2.0s)
  âœ“  5 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.9s)
  âœ“  4 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (2.3s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (1.2s)
  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (2.4s)

  6 passed (12.3s)
[release-verify] G2 api checks
All checks passed!
All done! âœ¨ ðŸ° âœ¨
1 file would be left unchanged.
Success: no issues found in 1 source file
[release-verify] G3/G4 live smoke
[staging-smoke] stripe smoke fake mode enabled
[staging-smoke] clearing existing listeners on 8012
[staging-smoke] starting local api on 127.0.0.1:8012
[staging-smoke] live F2 e2e

> test:e2e:live
> E2E_MODE=live playwright test e2e/core-flows.spec.ts -g "F2"


Running 1 test using 1 worker

  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (26.2s)

  1 passed (37.0s)
[staging-smoke] api+db+stripe live smoke
LIVE_SMOKE_OK
[staging-smoke] PASS
[release-verify] PASS
[2026-02-16 00:35:03] PASS [release-verify]
[2026-02-16 00:35:03] --- Cycle 2 PASS ---
[2026-02-16 00:35:03] --- Cycle 3 start ---
[2026-02-16 00:35:03] Cycle 3 attempt 1
[2026-02-16 00:35:03] RUN [api-pytest] cd /Users/taeksoojung/Desktop/RutineIQ/apps/api && .venv/bin/python -m pytest tests/ -v --tb=short
============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-8.3.4, pluggy-1.6.0 -- /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/taeksoojung/Desktop/RutineIQ/apps/api
configfile: pytest.ini
plugins: anyio-4.12.1, respx-0.22.0, asyncio-0.25.2
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=function
collecting ... collected 176 items

tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_01] PASSED [  0%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_02] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_03] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_04] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_05] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_01] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_02] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_03] PASSED [  4%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_04] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_05] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_01] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_02] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_03] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_04] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_05] PASSED [  8%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_01] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_02] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_03] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_04] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_05] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_01] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_02] PASSED [ 12%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_03] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_04] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_05] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_01] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_02] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_03] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_04] PASSED [ 16%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_05] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[worker_ko-ko-entries0-False-3-True] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[student_en-en-entries1-False-3-False] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[low_activity-ko-entries2-False-1-True] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[day2_with_yesterday_plan-ko-entries3-True-2-True] PASSED [ 19%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[high_activity-en-entries4-False-4-False] PASSED [ 19%]
tests/test_analyze_route.py::test_analyze_success_returns_report PASSED  [ 20%]
tests/test_analyze_route.py::test_analyze_returns_429_on_rate_limit PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_openai_failure_returns_502 PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_requires_auth PASSED           [ 22%]
tests/test_analyze_route.py::test_analyze_allows_first_run_with_incomplete_profile PASSED [ 22%]
tests/test_analyze_route.py::test_analyze_tracks_schema_retry_in_quality_meta PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_signal_rich_quality_score_is_higher_than_signal_poor PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_low_signal_data_adds_conservative_guidance PASSED [ 24%]
tests/test_e2e_flows.py::test_new_user_full_flow_save_parse_save_analyze_report PASSED [ 25%]
tests/test_e2e_flows.py::test_returning_user_flow_reuses_cached_report PASSED [ 25%]
tests/test_e2e_flows.py::test_preferences_and_cohort_flow_uses_updated_profile_filters PASSED [ 26%]
tests/test_e2e_flows.py::test_multi_day_trend_flow_posts_7_days_and_returns_weekly_insights PASSED [ 26%]
tests/test_error_cases.py::test_parse_diary_empty_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_parse_diary_too_long_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_analyze_with_future_date_is_handled PASSED [ 28%]
tests/test_error_cases.py::test_analyze_with_old_date_is_handled PASSED  [ 28%]
tests/test_error_cases.py::test_parse_diary_malformed_openai_output_returns_502 PASSED [ 29%]
tests/test_error_cases.py::test_reflect_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_suggest_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_analyze_malformed_openai_output_returns_502 PASSED [ 31%]
tests/test_error_cases.py::test_analyze_supabase_select_failure_returns_502_or_500 PASSED [ 31%]
tests/test_error_cases.py::test_reflect_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_suggest_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_analyze_missing_activity_log_still_returns_report PASSED [ 33%]
tests/test_error_cases.py::test_rate_limit_isolated_between_two_users PASSED [ 34%]
tests/test_health.py::test_health_returns_ok PASSED                      [ 34%]
tests/test_insights_route.py::test_weekly_insights_includes_streak_and_trend PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_resets_current_streak_when_today_missing PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_rejects_date_window_over_31_days PASSED [ 36%]
tests/test_logs_route.py::test_post_logs_creates_entry PASSED            [ 36%]
tests/test_logs_route.py::test_post_logs_duplicate_date_uses_upsert_on_conflict PASSED [ 37%]
tests/test_logs_route.py::test_get_logs_returns_saved_log PASSED         [ 38%]
tests/test_logs_route.py::test_logs_requires_auth PASSED                 [ 38%]
tests/test_logs_route.py::test_post_logs_updates_profile_streak_metrics PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_ignores_missing_streak_columns_until_migration_applied PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_persists_optional_daily_meta PASSED [ 40%]
tests/test_logs_route.py::test_post_logs_accepts_optional_entry_confidence PASSED [ 40%]
tests/test_openai_service.py::test_openai_service_parses_valid_response PASSED [ 41%]
tests/test_openai_service.py::test_openai_service_raises_on_invalid_json_output PASSED [ 42%]
tests/test_openai_service.py::test_openai_service_retries_then_succeeds PASSED [ 42%]
tests/test_parse.py::test_parse_diary_success PASSED                     [ 43%]
tests/test_parse.py::test_parse_diary_rejects_short_text PASSED          [ 43%]
tests/test_parse.py::test_parse_diary_request_schema_validation PASSED   [ 44%]
tests/test_parse.py::test_parse_diary_requires_auth PASSED               [ 44%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_01] PASSED [ 45%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_02] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_03] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_04] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_05] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_01] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_02] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_03] PASSED [ 49%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_04] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_05] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_01] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_02] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_03] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_04] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_05] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_01] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_02] PASSED [ 54%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_03] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_04] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_05] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_01] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_02] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_03] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_04] PASSED [ 58%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_05] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_01] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_02] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_03] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_04] PASSED [ 61%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_05] PASSED [ 61%]
tests/test_preferences_route.py::test_get_profile_returns_profile_with_job_family PASSED [ 62%]
tests/test_preferences_route.py::test_put_profile_updates_and_returns_profile PASSED [ 63%]
tests/test_preferences_route.py::test_put_profile_invalid_job_family_returns_422 PASSED [ 63%]
tests/test_preferences_route.py::test_delete_data_returns_ok_and_calls_supabase_delete PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[get-/api/preferences/profile-None] PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[put-/api/preferences/profile-payload1] PASSED [ 65%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[delete-/api/preferences/data-None] PASSED [ 65%]
tests/test_preferences_route.py::test_put_profile_deduplicates_trend_compare_by PASSED [ 66%]
tests/test_preferences_route.py::test_put_profile_falls_back_to_service_role_on_rls_error PASSED [ 67%]
tests/test_preferences_route.py::test_put_profile_returns_500_when_upsert_returns_empty_row PASSED [ 67%]
tests/test_reflect_route.py::test_reflect_happy_path_returns_question PASSED [ 68%]
tests/test_reflect_route.py::test_reflect_requires_auth PASSED           [ 68%]
tests/test_reflect_route.py::test_reflect_returns_429_when_daily_limit_exceeded PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_openai_failure_returns_502 PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_handles_empty_entries_gracefully PASSED [ 70%]
tests/test_reflect_route.py::test_reflect_rejects_missing_entries_field PASSED [ 71%]
tests/test_reflect_route.py::test_reflect_rejects_invalid_entries_type PASSED [ 71%]
tests/test_reports_route.py::test_reports_returns_existing_report PASSED [ 72%]
tests/test_reports_route.py::test_reports_returns_404_when_missing PASSED [ 72%]
tests/test_reports_route.py::test_reports_requires_auth PASSED           [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/logs-payload0] PASSED [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[get-/api/reports?date=2026-02-15-None] PASSED [ 74%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/analyze-payload2] PASSED [ 75%]
tests/test_security.py::test_expired_jwt_returns_401 PASSED              [ 75%]
tests/test_security.py::test_tampered_jwt_returns_401 PASSED             [ 76%]
tests/test_security.py::test_logs_get_scopes_queries_to_authenticated_user PASSED [ 76%]
tests/test_security.py::test_logs_post_forces_user_id_from_auth_context PASSED [ 77%]
tests/test_security.py::test_reports_get_scopes_queries_to_authenticated_user PASSED [ 77%]
tests/test_security.py::test_insights_weekly_scopes_queries_to_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_profile_get_scopes_by_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_delete_scopes_by_authenticated_user PASSED [ 79%]
tests/test_security.py::test_preferences_delete_removes_only_my_rows PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400 PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_replay_is_ignored PASSED     [ 81%]
tests/test_streaks_service.py::test_compute_streaks_returns_five_for_five_consecutive_days PASSED [ 81%]
tests/test_streaks_service.py::test_compute_streaks_resets_current_when_anchor_day_missing PASSED [ 82%]
tests/test_streaks_service.py::test_extract_log_dates_ignores_invalid_rows PASSED [ 82%]
tests/test_stripe_integration.py::test_stripe_status_returns_availability PASSED [ 83%]
tests/test_stripe_integration.py::test_stripe_status_requires_auth PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_happy_path PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_auth PASSED [ 85%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_email_identity PASSED [ 85%]
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription PASSED [ 86%]
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade PASSED [ 86%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature PASSED [ 87%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature PASSED [ 88%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature PASSED [ 88%]
tests/test_suggest_route.py::test_suggest_happy_path_returns_activity PASSED [ 89%]
tests/test_suggest_route.py::test_suggest_requires_auth PASSED           [ 89%]
tests/test_suggest_route.py::test_suggest_returns_429_when_daily_limit_exceeded PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_openai_failure_returns_502 PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_rejects_missing_required_fields PASSED [ 91%]
tests/test_suggest_route.py::test_suggest_accepts_null_context PASSED    [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_non_string_current_time PASSED [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_invalid_time_format PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_extracts_supabase_payload PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_uses_text_when_json_missing PASSED [ 94%]
tests/test_supabase_rest_service.py::test_select_wraps_single_object_as_list PASSED [ 94%]
tests/test_trends_route.py::test_trends_cohort_happy_path_includes_cohort_and_personal_metrics PASSED [ 95%]
tests/test_trends_route.py::test_trends_cohort_requires_auth PASSED      [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_disabled_when_opt_in_is_false PASSED [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_default_metrics_on_empty_rpc PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_unknown_query_params_do_not_break_response PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_uses_profile_filters_in_rpc_call PASSED [ 98%]
tests/test_usage_service.py::test_estimate_cost_usd_returns_value PASSED [ 98%]
tests/test_usage_service.py::test_count_daily_analyze_calls_counts_rows PASSED [ 99%]
tests/test_usage_service.py::test_insert_usage_event_fallbacks_when_service_conflict PASSED [100%]

=============================== warnings summary ===============================
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature
  /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/lib/python3.12/site-packages/httpx/_content.py:204: DeprecationWarning: Use 'content=<...>' to upload raw bytes/text content.
    warnings.warn(message, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 176 passed, 8 warnings in 1.35s ========================
[2026-02-16 00:35:06] PASS [api-pytest]
[2026-02-16 00:35:06] RUN [web-lint] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run lint

> lint
> next lint

âœ” No ESLint warnings or errors
[2026-02-16 00:35:07] PASS [web-lint]
[2026-02-16 00:35:07] RUN [web-typecheck] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run typecheck

> typecheck
> tsc --noEmit --incremental false

[2026-02-16 00:35:08] PASS [web-typecheck]
[2026-02-16 00:35:08] RUN [web-build] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run build

> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand

[2026-02-16 00:35:18] PASS [web-build]
[2026-02-16 00:35:18] RUN [web-e2e] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run test:e2e

> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.9s)
  âœ“  2 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (2.8s)
  âœ“  4 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (2.9s)
  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (3.2s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (1.3s)
  âœ“  3 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (3.2s)

  6 passed (14.7s)
[2026-02-16 00:35:33] PASS [web-e2e]
[2026-02-16 00:35:33] RUN [release-verify] cd /Users/taeksoojung/Desktop/RutineIQ && ./scripts/release-verify.sh
[release-verify] G1 web checks

> lint
> next lint

âœ” No ESLint warnings or errors

> typecheck
> tsc --noEmit --incremental false


> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand


> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.1s)
  âœ“  3 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.5s)
  âœ“  2 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.5s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (564ms)
  âœ“  4 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.8s)
  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (2.0s)

  6 passed (13.0s)
[release-verify] G2 api checks
All checks passed!
All done! âœ¨ ðŸ° âœ¨
1 file would be left unchanged.
Success: no issues found in 1 source file
[release-verify] G3/G4 live smoke
[staging-smoke] stripe smoke fake mode enabled
[staging-smoke] clearing existing listeners on 8012
[staging-smoke] starting local api on 127.0.0.1:8012
[staging-smoke] live F2 e2e

> test:e2e:live
> E2E_MODE=live playwright test e2e/core-flows.spec.ts -g "F2"


Running 1 test using 1 worker

  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (20.2s)

  1 passed (30.7s)
[staging-smoke] api+db+stripe live smoke
LIVE_SMOKE_OK
[staging-smoke] PASS
[release-verify] PASS
[2026-02-16 00:36:58] PASS [release-verify]
[2026-02-16 00:36:58] --- Cycle 3 PASS ---
[2026-02-16 00:36:58] --- Cycle 4 start ---
[2026-02-16 00:36:58] Cycle 4 attempt 1
[2026-02-16 00:36:58] RUN [api-pytest] cd /Users/taeksoojung/Desktop/RutineIQ/apps/api && .venv/bin/python -m pytest tests/ -v --tb=short
============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-8.3.4, pluggy-1.6.0 -- /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/taeksoojung/Desktop/RutineIQ/apps/api
configfile: pytest.ini
plugins: anyio-4.12.1, respx-0.22.0, asyncio-0.25.2
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=function
collecting ... collected 176 items

tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_01] PASSED [  0%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_02] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_03] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_04] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_05] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_01] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_02] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_03] PASSED [  4%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_04] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_05] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_01] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_02] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_03] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_04] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_05] PASSED [  8%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_01] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_02] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_03] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_04] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_05] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_01] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_02] PASSED [ 12%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_03] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_04] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_05] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_01] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_02] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_03] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_04] PASSED [ 16%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_05] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[worker_ko-ko-entries0-False-3-True] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[student_en-en-entries1-False-3-False] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[low_activity-ko-entries2-False-1-True] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[day2_with_yesterday_plan-ko-entries3-True-2-True] PASSED [ 19%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[high_activity-en-entries4-False-4-False] PASSED [ 19%]
tests/test_analyze_route.py::test_analyze_success_returns_report PASSED  [ 20%]
tests/test_analyze_route.py::test_analyze_returns_429_on_rate_limit PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_openai_failure_returns_502 PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_requires_auth PASSED           [ 22%]
tests/test_analyze_route.py::test_analyze_allows_first_run_with_incomplete_profile PASSED [ 22%]
tests/test_analyze_route.py::test_analyze_tracks_schema_retry_in_quality_meta PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_signal_rich_quality_score_is_higher_than_signal_poor PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_low_signal_data_adds_conservative_guidance PASSED [ 24%]
tests/test_e2e_flows.py::test_new_user_full_flow_save_parse_save_analyze_report PASSED [ 25%]
tests/test_e2e_flows.py::test_returning_user_flow_reuses_cached_report PASSED [ 25%]
tests/test_e2e_flows.py::test_preferences_and_cohort_flow_uses_updated_profile_filters PASSED [ 26%]
tests/test_e2e_flows.py::test_multi_day_trend_flow_posts_7_days_and_returns_weekly_insights PASSED [ 26%]
tests/test_error_cases.py::test_parse_diary_empty_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_parse_diary_too_long_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_analyze_with_future_date_is_handled PASSED [ 28%]
tests/test_error_cases.py::test_analyze_with_old_date_is_handled PASSED  [ 28%]
tests/test_error_cases.py::test_parse_diary_malformed_openai_output_returns_502 PASSED [ 29%]
tests/test_error_cases.py::test_reflect_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_suggest_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_analyze_malformed_openai_output_returns_502 PASSED [ 31%]
tests/test_error_cases.py::test_analyze_supabase_select_failure_returns_502_or_500 PASSED [ 31%]
tests/test_error_cases.py::test_reflect_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_suggest_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_analyze_missing_activity_log_still_returns_report PASSED [ 33%]
tests/test_error_cases.py::test_rate_limit_isolated_between_two_users PASSED [ 34%]
tests/test_health.py::test_health_returns_ok PASSED                      [ 34%]
tests/test_insights_route.py::test_weekly_insights_includes_streak_and_trend PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_resets_current_streak_when_today_missing PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_rejects_date_window_over_31_days PASSED [ 36%]
tests/test_logs_route.py::test_post_logs_creates_entry PASSED            [ 36%]
tests/test_logs_route.py::test_post_logs_duplicate_date_uses_upsert_on_conflict PASSED [ 37%]
tests/test_logs_route.py::test_get_logs_returns_saved_log PASSED         [ 38%]
tests/test_logs_route.py::test_logs_requires_auth PASSED                 [ 38%]
tests/test_logs_route.py::test_post_logs_updates_profile_streak_metrics PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_ignores_missing_streak_columns_until_migration_applied PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_persists_optional_daily_meta PASSED [ 40%]
tests/test_logs_route.py::test_post_logs_accepts_optional_entry_confidence PASSED [ 40%]
tests/test_openai_service.py::test_openai_service_parses_valid_response PASSED [ 41%]
tests/test_openai_service.py::test_openai_service_raises_on_invalid_json_output PASSED [ 42%]
tests/test_openai_service.py::test_openai_service_retries_then_succeeds PASSED [ 42%]
tests/test_parse.py::test_parse_diary_success PASSED                     [ 43%]
tests/test_parse.py::test_parse_diary_rejects_short_text PASSED          [ 43%]
tests/test_parse.py::test_parse_diary_request_schema_validation PASSED   [ 44%]
tests/test_parse.py::test_parse_diary_requires_auth PASSED               [ 44%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_01] PASSED [ 45%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_02] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_03] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_04] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_05] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_01] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_02] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_03] PASSED [ 49%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_04] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_05] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_01] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_02] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_03] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_04] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_05] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_01] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_02] PASSED [ 54%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_03] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_04] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_05] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_01] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_02] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_03] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_04] PASSED [ 58%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_05] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_01] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_02] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_03] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_04] PASSED [ 61%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_05] PASSED [ 61%]
tests/test_preferences_route.py::test_get_profile_returns_profile_with_job_family PASSED [ 62%]
tests/test_preferences_route.py::test_put_profile_updates_and_returns_profile PASSED [ 63%]
tests/test_preferences_route.py::test_put_profile_invalid_job_family_returns_422 PASSED [ 63%]
tests/test_preferences_route.py::test_delete_data_returns_ok_and_calls_supabase_delete PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[get-/api/preferences/profile-None] PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[put-/api/preferences/profile-payload1] PASSED [ 65%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[delete-/api/preferences/data-None] PASSED [ 65%]
tests/test_preferences_route.py::test_put_profile_deduplicates_trend_compare_by PASSED [ 66%]
tests/test_preferences_route.py::test_put_profile_falls_back_to_service_role_on_rls_error PASSED [ 67%]
tests/test_preferences_route.py::test_put_profile_returns_500_when_upsert_returns_empty_row PASSED [ 67%]
tests/test_reflect_route.py::test_reflect_happy_path_returns_question PASSED [ 68%]
tests/test_reflect_route.py::test_reflect_requires_auth PASSED           [ 68%]
tests/test_reflect_route.py::test_reflect_returns_429_when_daily_limit_exceeded PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_openai_failure_returns_502 PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_handles_empty_entries_gracefully PASSED [ 70%]
tests/test_reflect_route.py::test_reflect_rejects_missing_entries_field PASSED [ 71%]
tests/test_reflect_route.py::test_reflect_rejects_invalid_entries_type PASSED [ 71%]
tests/test_reports_route.py::test_reports_returns_existing_report PASSED [ 72%]
tests/test_reports_route.py::test_reports_returns_404_when_missing PASSED [ 72%]
tests/test_reports_route.py::test_reports_requires_auth PASSED           [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/logs-payload0] PASSED [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[get-/api/reports?date=2026-02-15-None] PASSED [ 74%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/analyze-payload2] PASSED [ 75%]
tests/test_security.py::test_expired_jwt_returns_401 PASSED              [ 75%]
tests/test_security.py::test_tampered_jwt_returns_401 PASSED             [ 76%]
tests/test_security.py::test_logs_get_scopes_queries_to_authenticated_user PASSED [ 76%]
tests/test_security.py::test_logs_post_forces_user_id_from_auth_context PASSED [ 77%]
tests/test_security.py::test_reports_get_scopes_queries_to_authenticated_user PASSED [ 77%]
tests/test_security.py::test_insights_weekly_scopes_queries_to_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_profile_get_scopes_by_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_delete_scopes_by_authenticated_user PASSED [ 79%]
tests/test_security.py::test_preferences_delete_removes_only_my_rows PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400 PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_replay_is_ignored PASSED     [ 81%]
tests/test_streaks_service.py::test_compute_streaks_returns_five_for_five_consecutive_days PASSED [ 81%]
tests/test_streaks_service.py::test_compute_streaks_resets_current_when_anchor_day_missing PASSED [ 82%]
tests/test_streaks_service.py::test_extract_log_dates_ignores_invalid_rows PASSED [ 82%]
tests/test_stripe_integration.py::test_stripe_status_returns_availability PASSED [ 83%]
tests/test_stripe_integration.py::test_stripe_status_requires_auth PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_happy_path PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_auth PASSED [ 85%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_email_identity PASSED [ 85%]
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription PASSED [ 86%]
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade PASSED [ 86%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature PASSED [ 87%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature PASSED [ 88%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature PASSED [ 88%]
tests/test_suggest_route.py::test_suggest_happy_path_returns_activity PASSED [ 89%]
tests/test_suggest_route.py::test_suggest_requires_auth PASSED           [ 89%]
tests/test_suggest_route.py::test_suggest_returns_429_when_daily_limit_exceeded PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_openai_failure_returns_502 PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_rejects_missing_required_fields PASSED [ 91%]
tests/test_suggest_route.py::test_suggest_accepts_null_context PASSED    [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_non_string_current_time PASSED [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_invalid_time_format PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_extracts_supabase_payload PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_uses_text_when_json_missing PASSED [ 94%]
tests/test_supabase_rest_service.py::test_select_wraps_single_object_as_list PASSED [ 94%]
tests/test_trends_route.py::test_trends_cohort_happy_path_includes_cohort_and_personal_metrics PASSED [ 95%]
tests/test_trends_route.py::test_trends_cohort_requires_auth PASSED      [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_disabled_when_opt_in_is_false PASSED [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_default_metrics_on_empty_rpc PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_unknown_query_params_do_not_break_response PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_uses_profile_filters_in_rpc_call PASSED [ 98%]
tests/test_usage_service.py::test_estimate_cost_usd_returns_value PASSED [ 98%]
tests/test_usage_service.py::test_count_daily_analyze_calls_counts_rows PASSED [ 99%]
tests/test_usage_service.py::test_insert_usage_event_fallbacks_when_service_conflict PASSED [100%]

=============================== warnings summary ===============================
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature
  /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/lib/python3.12/site-packages/httpx/_content.py:204: DeprecationWarning: Use 'content=<...>' to upload raw bytes/text content.
    warnings.warn(message, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 176 passed, 8 warnings in 0.97s ========================
[2026-02-16 00:37:00] PASS [api-pytest]
[2026-02-16 00:37:00] RUN [web-lint] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run lint

> lint
> next lint

âœ” No ESLint warnings or errors
[2026-02-16 00:37:01] PASS [web-lint]
[2026-02-16 00:37:01] RUN [web-typecheck] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run typecheck

> typecheck
> tsc --noEmit --incremental false

[2026-02-16 00:37:02] PASS [web-typecheck]
[2026-02-16 00:37:02] RUN [web-build] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run build

> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand

[2026-02-16 00:37:11] PASS [web-build]
[2026-02-16 00:37:11] RUN [web-e2e] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run test:e2e

> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  2 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.1s)
  âœ“  1 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.5s)
  âœ“  3 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.5s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (520ms)
  âœ“  4 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.7s)
  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (1.9s)

  6 passed (11.8s)
[2026-02-16 00:37:23] PASS [web-e2e]
[2026-02-16 00:37:23] RUN [release-verify] cd /Users/taeksoojung/Desktop/RutineIQ && ./scripts/release-verify.sh
[release-verify] G1 web checks

> lint
> next lint

âœ” No ESLint warnings or errors

> typecheck
> tsc --noEmit --incremental false


> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand


> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  3 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.2s)
  âœ“  5 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.5s)
  âœ“  4 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.5s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (542ms)
  âœ“  2 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (2.0s)
  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (2.2s)

  6 passed (12.1s)
[release-verify] G2 api checks
All checks passed!
All done! âœ¨ ðŸ° âœ¨
1 file would be left unchanged.
Success: no issues found in 1 source file
[release-verify] G3/G4 live smoke
[staging-smoke] stripe smoke fake mode enabled
[staging-smoke] clearing existing listeners on 8012
[staging-smoke] starting local api on 127.0.0.1:8012
[staging-smoke] live F2 e2e

> test:e2e:live
> E2E_MODE=live playwright test e2e/core-flows.spec.ts -g "F2"


Running 1 test using 1 worker

  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (22.8s)

  1 passed (34.0s)
[staging-smoke] api+db+stripe live smoke
LIVE_SMOKE_OK
[staging-smoke] PASS
[release-verify] PASS
[2026-02-16 00:38:52] PASS [release-verify]
[2026-02-16 00:38:52] --- Cycle 4 PASS ---
[2026-02-16 00:38:52] --- Cycle 5 start ---
[2026-02-16 00:38:52] Cycle 5 attempt 1
[2026-02-16 00:38:52] RUN [api-pytest] cd /Users/taeksoojung/Desktop/RutineIQ/apps/api && .venv/bin/python -m pytest tests/ -v --tb=short
============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-8.3.4, pluggy-1.6.0 -- /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/taeksoojung/Desktop/RutineIQ/apps/api
configfile: pytest.ini
plugins: anyio-4.12.1, respx-0.22.0, asyncio-0.25.2
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=function
collecting ... collected 176 items

tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_01] PASSED [  0%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_02] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_03] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_04] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_05] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_01] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_02] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_03] PASSED [  4%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_04] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_05] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_01] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_02] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_03] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_04] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_05] PASSED [  8%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_01] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_02] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_03] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_04] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_05] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_01] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_02] PASSED [ 12%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_03] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_04] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_05] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_01] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_02] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_03] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_04] PASSED [ 16%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_05] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[worker_ko-ko-entries0-False-3-True] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[student_en-en-entries1-False-3-False] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[low_activity-ko-entries2-False-1-True] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[day2_with_yesterday_plan-ko-entries3-True-2-True] PASSED [ 19%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[high_activity-en-entries4-False-4-False] PASSED [ 19%]
tests/test_analyze_route.py::test_analyze_success_returns_report PASSED  [ 20%]
tests/test_analyze_route.py::test_analyze_returns_429_on_rate_limit PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_openai_failure_returns_502 PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_requires_auth PASSED           [ 22%]
tests/test_analyze_route.py::test_analyze_allows_first_run_with_incomplete_profile PASSED [ 22%]
tests/test_analyze_route.py::test_analyze_tracks_schema_retry_in_quality_meta PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_signal_rich_quality_score_is_higher_than_signal_poor PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_low_signal_data_adds_conservative_guidance PASSED [ 24%]
tests/test_e2e_flows.py::test_new_user_full_flow_save_parse_save_analyze_report PASSED [ 25%]
tests/test_e2e_flows.py::test_returning_user_flow_reuses_cached_report PASSED [ 25%]
tests/test_e2e_flows.py::test_preferences_and_cohort_flow_uses_updated_profile_filters PASSED [ 26%]
tests/test_e2e_flows.py::test_multi_day_trend_flow_posts_7_days_and_returns_weekly_insights PASSED [ 26%]
tests/test_error_cases.py::test_parse_diary_empty_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_parse_diary_too_long_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_analyze_with_future_date_is_handled PASSED [ 28%]
tests/test_error_cases.py::test_analyze_with_old_date_is_handled PASSED  [ 28%]
tests/test_error_cases.py::test_parse_diary_malformed_openai_output_returns_502 PASSED [ 29%]
tests/test_error_cases.py::test_reflect_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_suggest_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_analyze_malformed_openai_output_returns_502 PASSED [ 31%]
tests/test_error_cases.py::test_analyze_supabase_select_failure_returns_502_or_500 PASSED [ 31%]
tests/test_error_cases.py::test_reflect_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_suggest_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_analyze_missing_activity_log_still_returns_report PASSED [ 33%]
tests/test_error_cases.py::test_rate_limit_isolated_between_two_users PASSED [ 34%]
tests/test_health.py::test_health_returns_ok PASSED                      [ 34%]
tests/test_insights_route.py::test_weekly_insights_includes_streak_and_trend PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_resets_current_streak_when_today_missing PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_rejects_date_window_over_31_days PASSED [ 36%]
tests/test_logs_route.py::test_post_logs_creates_entry PASSED            [ 36%]
tests/test_logs_route.py::test_post_logs_duplicate_date_uses_upsert_on_conflict PASSED [ 37%]
tests/test_logs_route.py::test_get_logs_returns_saved_log PASSED         [ 38%]
tests/test_logs_route.py::test_logs_requires_auth PASSED                 [ 38%]
tests/test_logs_route.py::test_post_logs_updates_profile_streak_metrics PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_ignores_missing_streak_columns_until_migration_applied PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_persists_optional_daily_meta PASSED [ 40%]
tests/test_logs_route.py::test_post_logs_accepts_optional_entry_confidence PASSED [ 40%]
tests/test_openai_service.py::test_openai_service_parses_valid_response PASSED [ 41%]
tests/test_openai_service.py::test_openai_service_raises_on_invalid_json_output PASSED [ 42%]
tests/test_openai_service.py::test_openai_service_retries_then_succeeds PASSED [ 42%]
tests/test_parse.py::test_parse_diary_success PASSED                     [ 43%]
tests/test_parse.py::test_parse_diary_rejects_short_text PASSED          [ 43%]
tests/test_parse.py::test_parse_diary_request_schema_validation PASSED   [ 44%]
tests/test_parse.py::test_parse_diary_requires_auth PASSED               [ 44%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_01] PASSED [ 45%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_02] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_03] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_04] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_05] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_01] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_02] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_03] PASSED [ 49%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_04] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_05] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_01] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_02] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_03] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_04] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_05] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_01] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_02] PASSED [ 54%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_03] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_04] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_05] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_01] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_02] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_03] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_04] PASSED [ 58%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_05] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_01] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_02] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_03] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_04] PASSED [ 61%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_05] PASSED [ 61%]
tests/test_preferences_route.py::test_get_profile_returns_profile_with_job_family PASSED [ 62%]
tests/test_preferences_route.py::test_put_profile_updates_and_returns_profile PASSED [ 63%]
tests/test_preferences_route.py::test_put_profile_invalid_job_family_returns_422 PASSED [ 63%]
tests/test_preferences_route.py::test_delete_data_returns_ok_and_calls_supabase_delete PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[get-/api/preferences/profile-None] PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[put-/api/preferences/profile-payload1] PASSED [ 65%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[delete-/api/preferences/data-None] PASSED [ 65%]
tests/test_preferences_route.py::test_put_profile_deduplicates_trend_compare_by PASSED [ 66%]
tests/test_preferences_route.py::test_put_profile_falls_back_to_service_role_on_rls_error PASSED [ 67%]
tests/test_preferences_route.py::test_put_profile_returns_500_when_upsert_returns_empty_row PASSED [ 67%]
tests/test_reflect_route.py::test_reflect_happy_path_returns_question PASSED [ 68%]
tests/test_reflect_route.py::test_reflect_requires_auth PASSED           [ 68%]
tests/test_reflect_route.py::test_reflect_returns_429_when_daily_limit_exceeded PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_openai_failure_returns_502 PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_handles_empty_entries_gracefully PASSED [ 70%]
tests/test_reflect_route.py::test_reflect_rejects_missing_entries_field PASSED [ 71%]
tests/test_reflect_route.py::test_reflect_rejects_invalid_entries_type PASSED [ 71%]
tests/test_reports_route.py::test_reports_returns_existing_report PASSED [ 72%]
tests/test_reports_route.py::test_reports_returns_404_when_missing PASSED [ 72%]
tests/test_reports_route.py::test_reports_requires_auth PASSED           [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/logs-payload0] PASSED [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[get-/api/reports?date=2026-02-15-None] PASSED [ 74%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/analyze-payload2] PASSED [ 75%]
tests/test_security.py::test_expired_jwt_returns_401 PASSED              [ 75%]
tests/test_security.py::test_tampered_jwt_returns_401 PASSED             [ 76%]
tests/test_security.py::test_logs_get_scopes_queries_to_authenticated_user PASSED [ 76%]
tests/test_security.py::test_logs_post_forces_user_id_from_auth_context PASSED [ 77%]
tests/test_security.py::test_reports_get_scopes_queries_to_authenticated_user PASSED [ 77%]
tests/test_security.py::test_insights_weekly_scopes_queries_to_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_profile_get_scopes_by_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_delete_scopes_by_authenticated_user PASSED [ 79%]
tests/test_security.py::test_preferences_delete_removes_only_my_rows PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400 PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_replay_is_ignored PASSED     [ 81%]
tests/test_streaks_service.py::test_compute_streaks_returns_five_for_five_consecutive_days PASSED [ 81%]
tests/test_streaks_service.py::test_compute_streaks_resets_current_when_anchor_day_missing PASSED [ 82%]
tests/test_streaks_service.py::test_extract_log_dates_ignores_invalid_rows PASSED [ 82%]
tests/test_stripe_integration.py::test_stripe_status_returns_availability PASSED [ 83%]
tests/test_stripe_integration.py::test_stripe_status_requires_auth PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_happy_path PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_auth PASSED [ 85%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_email_identity PASSED [ 85%]
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription PASSED [ 86%]
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade PASSED [ 86%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature PASSED [ 87%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature PASSED [ 88%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature PASSED [ 88%]
tests/test_suggest_route.py::test_suggest_happy_path_returns_activity PASSED [ 89%]
tests/test_suggest_route.py::test_suggest_requires_auth PASSED           [ 89%]
tests/test_suggest_route.py::test_suggest_returns_429_when_daily_limit_exceeded PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_openai_failure_returns_502 PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_rejects_missing_required_fields PASSED [ 91%]
tests/test_suggest_route.py::test_suggest_accepts_null_context PASSED    [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_non_string_current_time PASSED [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_invalid_time_format PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_extracts_supabase_payload PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_uses_text_when_json_missing PASSED [ 94%]
tests/test_supabase_rest_service.py::test_select_wraps_single_object_as_list PASSED [ 94%]
tests/test_trends_route.py::test_trends_cohort_happy_path_includes_cohort_and_personal_metrics PASSED [ 95%]
tests/test_trends_route.py::test_trends_cohort_requires_auth PASSED      [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_disabled_when_opt_in_is_false PASSED [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_default_metrics_on_empty_rpc PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_unknown_query_params_do_not_break_response PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_uses_profile_filters_in_rpc_call PASSED [ 98%]
tests/test_usage_service.py::test_estimate_cost_usd_returns_value PASSED [ 98%]
tests/test_usage_service.py::test_count_daily_analyze_calls_counts_rows PASSED [ 99%]
tests/test_usage_service.py::test_insert_usage_event_fallbacks_when_service_conflict PASSED [100%]

=============================== warnings summary ===============================
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature
  /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/lib/python3.12/site-packages/httpx/_content.py:204: DeprecationWarning: Use 'content=<...>' to upload raw bytes/text content.
    warnings.warn(message, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 176 passed, 8 warnings in 1.36s ========================
[2026-02-16 00:38:54] PASS [api-pytest]
[2026-02-16 00:38:54] RUN [web-lint] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run lint

> lint
> next lint

âœ” No ESLint warnings or errors
[2026-02-16 00:38:56] PASS [web-lint]
[2026-02-16 00:38:56] RUN [web-typecheck] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run typecheck

> typecheck
> tsc --noEmit --incremental false

[2026-02-16 00:38:57] PASS [web-typecheck]
[2026-02-16 00:38:57] RUN [web-build] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run build

> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand

[2026-02-16 00:39:07] PASS [web-build]
[2026-02-16 00:39:07] RUN [web-e2e] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run test:e2e

> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  2 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.1s)
  âœ“  1 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.5s)
  âœ“  3 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.5s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (562ms)
  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.8s)
  âœ“  4 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (2.0s)

  6 passed (13.1s)
[2026-02-16 00:39:20] PASS [web-e2e]
[2026-02-16 00:39:20] RUN [release-verify] cd /Users/taeksoojung/Desktop/RutineIQ && ./scripts/release-verify.sh
[release-verify] G1 web checks

> lint
> next lint

âœ” No ESLint warnings or errors

> typecheck
> tsc --noEmit --incremental false


> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand


> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (802ms)
  âœ“  1 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.3s)
  âœ“  2 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.3s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (661ms)
  âœ“  3 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.7s)
  âœ“  4 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (1.8s)

  6 passed (11.7s)
[release-verify] G2 api checks
All checks passed!
All done! âœ¨ ðŸ° âœ¨
1 file would be left unchanged.
Success: no issues found in 1 source file
[release-verify] G3/G4 live smoke
[staging-smoke] stripe smoke fake mode enabled
[staging-smoke] clearing existing listeners on 8012
[staging-smoke] starting local api on 127.0.0.1:8012
[staging-smoke] live F2 e2e

> test:e2e:live
> E2E_MODE=live playwright test e2e/core-flows.spec.ts -g "F2"


Running 1 test using 1 worker

  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (23.2s)

  1 passed (33.7s)
[staging-smoke] api+db+stripe live smoke
LIVE_SMOKE_OK
[staging-smoke] PASS
[release-verify] PASS
[2026-02-16 00:40:48] PASS [release-verify]
[2026-02-16 00:40:48] --- Cycle 5 PASS ---
[2026-02-16 00:40:48] --- Cycle 6 start ---
[2026-02-16 00:40:48] Cycle 6 attempt 1
[2026-02-16 00:40:48] RUN [api-pytest] cd /Users/taeksoojung/Desktop/RutineIQ/apps/api && .venv/bin/python -m pytest tests/ -v --tb=short
============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-8.3.4, pluggy-1.6.0 -- /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/taeksoojung/Desktop/RutineIQ/apps/api
configfile: pytest.ini
plugins: anyio-4.12.1, respx-0.22.0, asyncio-0.25.2
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=function
collecting ... collected 176 items

tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_01] PASSED [  0%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_02] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_03] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_04] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_05] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_01] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_02] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_03] PASSED [  4%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_04] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_05] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_01] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_02] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_03] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_04] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_05] PASSED [  8%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_01] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_02] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_03] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_04] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_05] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_01] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_02] PASSED [ 12%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_03] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_04] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_05] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_01] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_02] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_03] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_04] PASSED [ 16%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_05] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[worker_ko-ko-entries0-False-3-True] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[student_en-en-entries1-False-3-False] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[low_activity-ko-entries2-False-1-True] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[day2_with_yesterday_plan-ko-entries3-True-2-True] PASSED [ 19%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[high_activity-en-entries4-False-4-False] PASSED [ 19%]
tests/test_analyze_route.py::test_analyze_success_returns_report PASSED  [ 20%]
tests/test_analyze_route.py::test_analyze_returns_429_on_rate_limit PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_openai_failure_returns_502 PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_requires_auth PASSED           [ 22%]
tests/test_analyze_route.py::test_analyze_allows_first_run_with_incomplete_profile PASSED [ 22%]
tests/test_analyze_route.py::test_analyze_tracks_schema_retry_in_quality_meta PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_signal_rich_quality_score_is_higher_than_signal_poor PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_low_signal_data_adds_conservative_guidance PASSED [ 24%]
tests/test_e2e_flows.py::test_new_user_full_flow_save_parse_save_analyze_report PASSED [ 25%]
tests/test_e2e_flows.py::test_returning_user_flow_reuses_cached_report PASSED [ 25%]
tests/test_e2e_flows.py::test_preferences_and_cohort_flow_uses_updated_profile_filters PASSED [ 26%]
tests/test_e2e_flows.py::test_multi_day_trend_flow_posts_7_days_and_returns_weekly_insights PASSED [ 26%]
tests/test_error_cases.py::test_parse_diary_empty_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_parse_diary_too_long_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_analyze_with_future_date_is_handled PASSED [ 28%]
tests/test_error_cases.py::test_analyze_with_old_date_is_handled PASSED  [ 28%]
tests/test_error_cases.py::test_parse_diary_malformed_openai_output_returns_502 PASSED [ 29%]
tests/test_error_cases.py::test_reflect_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_suggest_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_analyze_malformed_openai_output_returns_502 PASSED [ 31%]
tests/test_error_cases.py::test_analyze_supabase_select_failure_returns_502_or_500 PASSED [ 31%]
tests/test_error_cases.py::test_reflect_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_suggest_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_analyze_missing_activity_log_still_returns_report PASSED [ 33%]
tests/test_error_cases.py::test_rate_limit_isolated_between_two_users PASSED [ 34%]
tests/test_health.py::test_health_returns_ok PASSED                      [ 34%]
tests/test_insights_route.py::test_weekly_insights_includes_streak_and_trend PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_resets_current_streak_when_today_missing PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_rejects_date_window_over_31_days PASSED [ 36%]
tests/test_logs_route.py::test_post_logs_creates_entry PASSED            [ 36%]
tests/test_logs_route.py::test_post_logs_duplicate_date_uses_upsert_on_conflict PASSED [ 37%]
tests/test_logs_route.py::test_get_logs_returns_saved_log PASSED         [ 38%]
tests/test_logs_route.py::test_logs_requires_auth PASSED                 [ 38%]
tests/test_logs_route.py::test_post_logs_updates_profile_streak_metrics PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_ignores_missing_streak_columns_until_migration_applied PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_persists_optional_daily_meta PASSED [ 40%]
tests/test_logs_route.py::test_post_logs_accepts_optional_entry_confidence PASSED [ 40%]
tests/test_openai_service.py::test_openai_service_parses_valid_response PASSED [ 41%]
tests/test_openai_service.py::test_openai_service_raises_on_invalid_json_output PASSED [ 42%]
tests/test_openai_service.py::test_openai_service_retries_then_succeeds PASSED [ 42%]
tests/test_parse.py::test_parse_diary_success PASSED                     [ 43%]
tests/test_parse.py::test_parse_diary_rejects_short_text PASSED          [ 43%]
tests/test_parse.py::test_parse_diary_request_schema_validation PASSED   [ 44%]
tests/test_parse.py::test_parse_diary_requires_auth PASSED               [ 44%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_01] PASSED [ 45%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_02] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_03] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_04] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_05] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_01] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_02] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_03] PASSED [ 49%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_04] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_05] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_01] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_02] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_03] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_04] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_05] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_01] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_02] PASSED [ 54%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_03] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_04] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_05] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_01] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_02] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_03] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_04] PASSED [ 58%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_05] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_01] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_02] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_03] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_04] PASSED [ 61%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_05] PASSED [ 61%]
tests/test_preferences_route.py::test_get_profile_returns_profile_with_job_family PASSED [ 62%]
tests/test_preferences_route.py::test_put_profile_updates_and_returns_profile PASSED [ 63%]
tests/test_preferences_route.py::test_put_profile_invalid_job_family_returns_422 PASSED [ 63%]
tests/test_preferences_route.py::test_delete_data_returns_ok_and_calls_supabase_delete PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[get-/api/preferences/profile-None] PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[put-/api/preferences/profile-payload1] PASSED [ 65%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[delete-/api/preferences/data-None] PASSED [ 65%]
tests/test_preferences_route.py::test_put_profile_deduplicates_trend_compare_by PASSED [ 66%]
tests/test_preferences_route.py::test_put_profile_falls_back_to_service_role_on_rls_error PASSED [ 67%]
tests/test_preferences_route.py::test_put_profile_returns_500_when_upsert_returns_empty_row PASSED [ 67%]
tests/test_reflect_route.py::test_reflect_happy_path_returns_question PASSED [ 68%]
tests/test_reflect_route.py::test_reflect_requires_auth PASSED           [ 68%]
tests/test_reflect_route.py::test_reflect_returns_429_when_daily_limit_exceeded PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_openai_failure_returns_502 PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_handles_empty_entries_gracefully PASSED [ 70%]
tests/test_reflect_route.py::test_reflect_rejects_missing_entries_field PASSED [ 71%]
tests/test_reflect_route.py::test_reflect_rejects_invalid_entries_type PASSED [ 71%]
tests/test_reports_route.py::test_reports_returns_existing_report PASSED [ 72%]
tests/test_reports_route.py::test_reports_returns_404_when_missing PASSED [ 72%]
tests/test_reports_route.py::test_reports_requires_auth PASSED           [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/logs-payload0] PASSED [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[get-/api/reports?date=2026-02-15-None] PASSED [ 74%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/analyze-payload2] PASSED [ 75%]
tests/test_security.py::test_expired_jwt_returns_401 PASSED              [ 75%]
tests/test_security.py::test_tampered_jwt_returns_401 PASSED             [ 76%]
tests/test_security.py::test_logs_get_scopes_queries_to_authenticated_user PASSED [ 76%]
tests/test_security.py::test_logs_post_forces_user_id_from_auth_context PASSED [ 77%]
tests/test_security.py::test_reports_get_scopes_queries_to_authenticated_user PASSED [ 77%]
tests/test_security.py::test_insights_weekly_scopes_queries_to_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_profile_get_scopes_by_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_delete_scopes_by_authenticated_user PASSED [ 79%]
tests/test_security.py::test_preferences_delete_removes_only_my_rows PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400 PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_replay_is_ignored PASSED     [ 81%]
tests/test_streaks_service.py::test_compute_streaks_returns_five_for_five_consecutive_days PASSED [ 81%]
tests/test_streaks_service.py::test_compute_streaks_resets_current_when_anchor_day_missing PASSED [ 82%]
tests/test_streaks_service.py::test_extract_log_dates_ignores_invalid_rows PASSED [ 82%]
tests/test_stripe_integration.py::test_stripe_status_returns_availability PASSED [ 83%]
tests/test_stripe_integration.py::test_stripe_status_requires_auth PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_happy_path PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_auth PASSED [ 85%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_email_identity PASSED [ 85%]
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription PASSED [ 86%]
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade PASSED [ 86%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature PASSED [ 87%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature PASSED [ 88%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature PASSED [ 88%]
tests/test_suggest_route.py::test_suggest_happy_path_returns_activity PASSED [ 89%]
tests/test_suggest_route.py::test_suggest_requires_auth PASSED           [ 89%]
tests/test_suggest_route.py::test_suggest_returns_429_when_daily_limit_exceeded PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_openai_failure_returns_502 PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_rejects_missing_required_fields PASSED [ 91%]
tests/test_suggest_route.py::test_suggest_accepts_null_context PASSED    [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_non_string_current_time PASSED [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_invalid_time_format PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_extracts_supabase_payload PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_uses_text_when_json_missing PASSED [ 94%]
tests/test_supabase_rest_service.py::test_select_wraps_single_object_as_list PASSED [ 94%]
tests/test_trends_route.py::test_trends_cohort_happy_path_includes_cohort_and_personal_metrics PASSED [ 95%]
tests/test_trends_route.py::test_trends_cohort_requires_auth PASSED      [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_disabled_when_opt_in_is_false PASSED [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_default_metrics_on_empty_rpc PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_unknown_query_params_do_not_break_response PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_uses_profile_filters_in_rpc_call PASSED [ 98%]
tests/test_usage_service.py::test_estimate_cost_usd_returns_value PASSED [ 98%]
tests/test_usage_service.py::test_count_daily_analyze_calls_counts_rows PASSED [ 99%]
tests/test_usage_service.py::test_insert_usage_event_fallbacks_when_service_conflict PASSED [100%]

=============================== warnings summary ===============================
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature
  /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/lib/python3.12/site-packages/httpx/_content.py:204: DeprecationWarning: Use 'content=<...>' to upload raw bytes/text content.
    warnings.warn(message, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 176 passed, 8 warnings in 1.48s ========================
[2026-02-16 00:40:50] PASS [api-pytest]
[2026-02-16 00:40:50] RUN [web-lint] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run lint

> lint
> next lint

âœ” No ESLint warnings or errors
[2026-02-16 00:40:52] PASS [web-lint]
[2026-02-16 00:40:52] RUN [web-typecheck] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run typecheck

> typecheck
> tsc --noEmit --incremental false

[2026-02-16 00:40:53] PASS [web-typecheck]
[2026-02-16 00:40:53] RUN [web-build] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run build

> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand

[2026-02-16 00:41:02] PASS [web-build]
[2026-02-16 00:41:02] RUN [web-e2e] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run test:e2e

> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.2s)
  âœ“  1 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.5s)
  âœ“  3 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.5s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (602ms)
  âœ“  4 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.8s)
  âœ“  2 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (2.1s)

  6 passed (13.0s)
[2026-02-16 00:41:15] PASS [web-e2e]
[2026-02-16 00:41:15] RUN [release-verify] cd /Users/taeksoojung/Desktop/RutineIQ && ./scripts/release-verify.sh
[release-verify] G1 web checks

> lint
> next lint

âœ” No ESLint warnings or errors

> typecheck
> tsc --noEmit --incremental false


> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand


> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (942ms)
  âœ“  3 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.2s)
  âœ“  5 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.1s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (511ms)
  âœ“  4 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.6s)
  âœ“  2 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (1.8s)

  6 passed (11.6s)
[release-verify] G2 api checks
All checks passed!
All done! âœ¨ ðŸ° âœ¨
1 file would be left unchanged.
Success: no issues found in 1 source file
[release-verify] G3/G4 live smoke
[staging-smoke] stripe smoke fake mode enabled
[staging-smoke] clearing existing listeners on 8012
[staging-smoke] starting local api on 127.0.0.1:8012
[staging-smoke] live F2 e2e

> test:e2e:live
> E2E_MODE=live playwright test e2e/core-flows.spec.ts -g "F2"


Running 1 test using 1 worker

  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (22.4s)

  1 passed (33.1s)
[staging-smoke] api+db+stripe live smoke
LIVE_SMOKE_OK
[staging-smoke] PASS
[release-verify] PASS
[2026-02-16 00:42:45] PASS [release-verify]
[2026-02-16 00:42:45] --- Cycle 6 PASS ---
[2026-02-16 00:42:45] --- Cycle 7 start ---
[2026-02-16 00:42:45] Cycle 7 attempt 1
[2026-02-16 00:42:45] RUN [api-pytest] cd /Users/taeksoojung/Desktop/RutineIQ/apps/api && .venv/bin/python -m pytest tests/ -v --tb=short
============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-8.3.4, pluggy-1.6.0 -- /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/taeksoojung/Desktop/RutineIQ/apps/api
configfile: pytest.ini
plugins: anyio-4.12.1, respx-0.22.0, asyncio-0.25.2
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=function
collecting ... collected 176 items

tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_01] PASSED [  0%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_02] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_03] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_04] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_05] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_01] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_02] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_03] PASSED [  4%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_04] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_05] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_01] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_02] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_03] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_04] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_05] PASSED [  8%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_01] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_02] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_03] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_04] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_05] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_01] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_02] PASSED [ 12%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_03] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_04] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_05] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_01] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_02] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_03] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_04] PASSED [ 16%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_05] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[worker_ko-ko-entries0-False-3-True] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[student_en-en-entries1-False-3-False] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[low_activity-ko-entries2-False-1-True] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[day2_with_yesterday_plan-ko-entries3-True-2-True] PASSED [ 19%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[high_activity-en-entries4-False-4-False] PASSED [ 19%]
tests/test_analyze_route.py::test_analyze_success_returns_report PASSED  [ 20%]
tests/test_analyze_route.py::test_analyze_returns_429_on_rate_limit PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_openai_failure_returns_502 PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_requires_auth PASSED           [ 22%]
tests/test_analyze_route.py::test_analyze_allows_first_run_with_incomplete_profile PASSED [ 22%]
tests/test_analyze_route.py::test_analyze_tracks_schema_retry_in_quality_meta PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_signal_rich_quality_score_is_higher_than_signal_poor PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_low_signal_data_adds_conservative_guidance PASSED [ 24%]
tests/test_e2e_flows.py::test_new_user_full_flow_save_parse_save_analyze_report PASSED [ 25%]
tests/test_e2e_flows.py::test_returning_user_flow_reuses_cached_report PASSED [ 25%]
tests/test_e2e_flows.py::test_preferences_and_cohort_flow_uses_updated_profile_filters PASSED [ 26%]
tests/test_e2e_flows.py::test_multi_day_trend_flow_posts_7_days_and_returns_weekly_insights PASSED [ 26%]
tests/test_error_cases.py::test_parse_diary_empty_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_parse_diary_too_long_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_analyze_with_future_date_is_handled PASSED [ 28%]
tests/test_error_cases.py::test_analyze_with_old_date_is_handled PASSED  [ 28%]
tests/test_error_cases.py::test_parse_diary_malformed_openai_output_returns_502 PASSED [ 29%]
tests/test_error_cases.py::test_reflect_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_suggest_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_analyze_malformed_openai_output_returns_502 PASSED [ 31%]
tests/test_error_cases.py::test_analyze_supabase_select_failure_returns_502_or_500 PASSED [ 31%]
tests/test_error_cases.py::test_reflect_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_suggest_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_analyze_missing_activity_log_still_returns_report PASSED [ 33%]
tests/test_error_cases.py::test_rate_limit_isolated_between_two_users PASSED [ 34%]
tests/test_health.py::test_health_returns_ok PASSED                      [ 34%]
tests/test_insights_route.py::test_weekly_insights_includes_streak_and_trend PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_resets_current_streak_when_today_missing PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_rejects_date_window_over_31_days PASSED [ 36%]
tests/test_logs_route.py::test_post_logs_creates_entry PASSED            [ 36%]
tests/test_logs_route.py::test_post_logs_duplicate_date_uses_upsert_on_conflict PASSED [ 37%]
tests/test_logs_route.py::test_get_logs_returns_saved_log PASSED         [ 38%]
tests/test_logs_route.py::test_logs_requires_auth PASSED                 [ 38%]
tests/test_logs_route.py::test_post_logs_updates_profile_streak_metrics PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_ignores_missing_streak_columns_until_migration_applied PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_persists_optional_daily_meta PASSED [ 40%]
tests/test_logs_route.py::test_post_logs_accepts_optional_entry_confidence PASSED [ 40%]
tests/test_openai_service.py::test_openai_service_parses_valid_response PASSED [ 41%]
tests/test_openai_service.py::test_openai_service_raises_on_invalid_json_output PASSED [ 42%]
tests/test_openai_service.py::test_openai_service_retries_then_succeeds PASSED [ 42%]
tests/test_parse.py::test_parse_diary_success PASSED                     [ 43%]
tests/test_parse.py::test_parse_diary_rejects_short_text PASSED          [ 43%]
tests/test_parse.py::test_parse_diary_request_schema_validation PASSED   [ 44%]
tests/test_parse.py::test_parse_diary_requires_auth PASSED               [ 44%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_01] PASSED [ 45%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_02] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_03] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_04] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_05] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_01] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_02] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_03] PASSED [ 49%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_04] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_05] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_01] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_02] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_03] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_04] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_05] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_01] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_02] PASSED [ 54%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_03] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_04] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_05] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_01] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_02] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_03] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_04] PASSED [ 58%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_05] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_01] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_02] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_03] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_04] PASSED [ 61%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_05] PASSED [ 61%]
tests/test_preferences_route.py::test_get_profile_returns_profile_with_job_family PASSED [ 62%]
tests/test_preferences_route.py::test_put_profile_updates_and_returns_profile PASSED [ 63%]
tests/test_preferences_route.py::test_put_profile_invalid_job_family_returns_422 PASSED [ 63%]
tests/test_preferences_route.py::test_delete_data_returns_ok_and_calls_supabase_delete PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[get-/api/preferences/profile-None] PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[put-/api/preferences/profile-payload1] PASSED [ 65%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[delete-/api/preferences/data-None] PASSED [ 65%]
tests/test_preferences_route.py::test_put_profile_deduplicates_trend_compare_by PASSED [ 66%]
tests/test_preferences_route.py::test_put_profile_falls_back_to_service_role_on_rls_error PASSED [ 67%]
tests/test_preferences_route.py::test_put_profile_returns_500_when_upsert_returns_empty_row PASSED [ 67%]
tests/test_reflect_route.py::test_reflect_happy_path_returns_question PASSED [ 68%]
tests/test_reflect_route.py::test_reflect_requires_auth PASSED           [ 68%]
tests/test_reflect_route.py::test_reflect_returns_429_when_daily_limit_exceeded PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_openai_failure_returns_502 PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_handles_empty_entries_gracefully PASSED [ 70%]
tests/test_reflect_route.py::test_reflect_rejects_missing_entries_field PASSED [ 71%]
tests/test_reflect_route.py::test_reflect_rejects_invalid_entries_type PASSED [ 71%]
tests/test_reports_route.py::test_reports_returns_existing_report PASSED [ 72%]
tests/test_reports_route.py::test_reports_returns_404_when_missing PASSED [ 72%]
tests/test_reports_route.py::test_reports_requires_auth PASSED           [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/logs-payload0] PASSED [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[get-/api/reports?date=2026-02-15-None] PASSED [ 74%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/analyze-payload2] PASSED [ 75%]
tests/test_security.py::test_expired_jwt_returns_401 PASSED              [ 75%]
tests/test_security.py::test_tampered_jwt_returns_401 PASSED             [ 76%]
tests/test_security.py::test_logs_get_scopes_queries_to_authenticated_user PASSED [ 76%]
tests/test_security.py::test_logs_post_forces_user_id_from_auth_context PASSED [ 77%]
tests/test_security.py::test_reports_get_scopes_queries_to_authenticated_user PASSED [ 77%]
tests/test_security.py::test_insights_weekly_scopes_queries_to_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_profile_get_scopes_by_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_delete_scopes_by_authenticated_user PASSED [ 79%]
tests/test_security.py::test_preferences_delete_removes_only_my_rows PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400 PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_replay_is_ignored PASSED     [ 81%]
tests/test_streaks_service.py::test_compute_streaks_returns_five_for_five_consecutive_days PASSED [ 81%]
tests/test_streaks_service.py::test_compute_streaks_resets_current_when_anchor_day_missing PASSED [ 82%]
tests/test_streaks_service.py::test_extract_log_dates_ignores_invalid_rows PASSED [ 82%]
tests/test_stripe_integration.py::test_stripe_status_returns_availability PASSED [ 83%]
tests/test_stripe_integration.py::test_stripe_status_requires_auth PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_happy_path PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_auth PASSED [ 85%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_email_identity PASSED [ 85%]
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription PASSED [ 86%]
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade PASSED [ 86%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature PASSED [ 87%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature PASSED [ 88%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature PASSED [ 88%]
tests/test_suggest_route.py::test_suggest_happy_path_returns_activity PASSED [ 89%]
tests/test_suggest_route.py::test_suggest_requires_auth PASSED           [ 89%]
tests/test_suggest_route.py::test_suggest_returns_429_when_daily_limit_exceeded PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_openai_failure_returns_502 PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_rejects_missing_required_fields PASSED [ 91%]
tests/test_suggest_route.py::test_suggest_accepts_null_context PASSED    [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_non_string_current_time PASSED [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_invalid_time_format PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_extracts_supabase_payload PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_uses_text_when_json_missing PASSED [ 94%]
tests/test_supabase_rest_service.py::test_select_wraps_single_object_as_list PASSED [ 94%]
tests/test_trends_route.py::test_trends_cohort_happy_path_includes_cohort_and_personal_metrics PASSED [ 95%]
tests/test_trends_route.py::test_trends_cohort_requires_auth PASSED      [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_disabled_when_opt_in_is_false PASSED [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_default_metrics_on_empty_rpc PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_unknown_query_params_do_not_break_response PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_uses_profile_filters_in_rpc_call PASSED [ 98%]
tests/test_usage_service.py::test_estimate_cost_usd_returns_value PASSED [ 98%]
tests/test_usage_service.py::test_count_daily_analyze_calls_counts_rows PASSED [ 99%]
tests/test_usage_service.py::test_insert_usage_event_fallbacks_when_service_conflict PASSED [100%]

=============================== warnings summary ===============================
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature
  /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/lib/python3.12/site-packages/httpx/_content.py:204: DeprecationWarning: Use 'content=<...>' to upload raw bytes/text content.
    warnings.warn(message, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 176 passed, 8 warnings in 1.40s ========================
[2026-02-16 00:42:47] PASS [api-pytest]
[2026-02-16 00:42:47] RUN [web-lint] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run lint

> lint
> next lint

âœ” No ESLint warnings or errors
[2026-02-16 00:42:49] PASS [web-lint]
[2026-02-16 00:42:49] RUN [web-typecheck] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run typecheck

> typecheck
> tsc --noEmit --incremental false

[2026-02-16 00:42:50] PASS [web-typecheck]
[2026-02-16 00:42:50] RUN [web-build] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run build

> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand

[2026-02-16 00:43:00] PASS [web-build]
[2026-02-16 00:43:00] RUN [web-e2e] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run test:e2e

> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  3 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.1s)
  âœ“  4 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.4s)
  âœ“  2 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.5s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (521ms)
  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.8s)
  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (2.0s)

  6 passed (13.1s)
[2026-02-16 00:43:13] PASS [web-e2e]
[2026-02-16 00:43:13] RUN [release-verify] cd /Users/taeksoojung/Desktop/RutineIQ && ./scripts/release-verify.sh
[release-verify] G1 web checks

> lint
> next lint

âœ” No ESLint warnings or errors

> typecheck
> tsc --noEmit --incremental false


> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand


> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (904ms)
  âœ“  3 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.3s)
  âœ“  1 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.3s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (645ms)
  âœ“  4 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.7s)
  âœ“  2 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (1.9s)

  6 passed (12.8s)
[release-verify] G2 api checks
All checks passed!
All done! âœ¨ ðŸ° âœ¨
1 file would be left unchanged.
Success: no issues found in 1 source file
[release-verify] G3/G4 live smoke
[staging-smoke] stripe smoke fake mode enabled
[staging-smoke] clearing existing listeners on 8012
[staging-smoke] starting local api on 127.0.0.1:8012
[staging-smoke] live F2 e2e

> test:e2e:live
> E2E_MODE=live playwright test e2e/core-flows.spec.ts -g "F2"


Running 1 test using 1 worker

  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (17.2s)

  1 passed (27.9s)
[staging-smoke] api+db+stripe live smoke
LIVE_SMOKE_OK
[staging-smoke] PASS
[release-verify] PASS
[2026-02-16 00:44:33] PASS [release-verify]
[2026-02-16 00:44:33] --- Cycle 7 PASS ---
[2026-02-16 00:44:33] --- Cycle 8 start ---
[2026-02-16 00:44:33] Cycle 8 attempt 1
[2026-02-16 00:44:33] RUN [api-pytest] cd /Users/taeksoojung/Desktop/RutineIQ/apps/api && .venv/bin/python -m pytest tests/ -v --tb=short
============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-8.3.4, pluggy-1.6.0 -- /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/taeksoojung/Desktop/RutineIQ/apps/api
configfile: pytest.ini
plugins: anyio-4.12.1, respx-0.22.0, asyncio-0.25.2
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=function
collecting ... collected 176 items

tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_01] PASSED [  0%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_02] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_03] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_04] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_05] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_01] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_02] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_03] PASSED [  4%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_04] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_05] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_01] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_02] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_03] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_04] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_05] PASSED [  8%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_01] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_02] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_03] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_04] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_05] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_01] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_02] PASSED [ 12%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_03] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_04] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_05] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_01] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_02] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_03] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_04] PASSED [ 16%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_05] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[worker_ko-ko-entries0-False-3-True] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[student_en-en-entries1-False-3-False] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[low_activity-ko-entries2-False-1-True] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[day2_with_yesterday_plan-ko-entries3-True-2-True] PASSED [ 19%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[high_activity-en-entries4-False-4-False] PASSED [ 19%]
tests/test_analyze_route.py::test_analyze_success_returns_report PASSED  [ 20%]
tests/test_analyze_route.py::test_analyze_returns_429_on_rate_limit PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_openai_failure_returns_502 PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_requires_auth PASSED           [ 22%]
tests/test_analyze_route.py::test_analyze_allows_first_run_with_incomplete_profile PASSED [ 22%]
tests/test_analyze_route.py::test_analyze_tracks_schema_retry_in_quality_meta PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_signal_rich_quality_score_is_higher_than_signal_poor PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_low_signal_data_adds_conservative_guidance PASSED [ 24%]
tests/test_e2e_flows.py::test_new_user_full_flow_save_parse_save_analyze_report PASSED [ 25%]
tests/test_e2e_flows.py::test_returning_user_flow_reuses_cached_report PASSED [ 25%]
tests/test_e2e_flows.py::test_preferences_and_cohort_flow_uses_updated_profile_filters PASSED [ 26%]
tests/test_e2e_flows.py::test_multi_day_trend_flow_posts_7_days_and_returns_weekly_insights PASSED [ 26%]
tests/test_error_cases.py::test_parse_diary_empty_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_parse_diary_too_long_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_analyze_with_future_date_is_handled PASSED [ 28%]
tests/test_error_cases.py::test_analyze_with_old_date_is_handled PASSED  [ 28%]
tests/test_error_cases.py::test_parse_diary_malformed_openai_output_returns_502 PASSED [ 29%]
tests/test_error_cases.py::test_reflect_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_suggest_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_analyze_malformed_openai_output_returns_502 PASSED [ 31%]
tests/test_error_cases.py::test_analyze_supabase_select_failure_returns_502_or_500 PASSED [ 31%]
tests/test_error_cases.py::test_reflect_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_suggest_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_analyze_missing_activity_log_still_returns_report PASSED [ 33%]
tests/test_error_cases.py::test_rate_limit_isolated_between_two_users PASSED [ 34%]
tests/test_health.py::test_health_returns_ok PASSED                      [ 34%]
tests/test_insights_route.py::test_weekly_insights_includes_streak_and_trend PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_resets_current_streak_when_today_missing PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_rejects_date_window_over_31_days PASSED [ 36%]
tests/test_logs_route.py::test_post_logs_creates_entry PASSED            [ 36%]
tests/test_logs_route.py::test_post_logs_duplicate_date_uses_upsert_on_conflict PASSED [ 37%]
tests/test_logs_route.py::test_get_logs_returns_saved_log PASSED         [ 38%]
tests/test_logs_route.py::test_logs_requires_auth PASSED                 [ 38%]
tests/test_logs_route.py::test_post_logs_updates_profile_streak_metrics PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_ignores_missing_streak_columns_until_migration_applied PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_persists_optional_daily_meta PASSED [ 40%]
tests/test_logs_route.py::test_post_logs_accepts_optional_entry_confidence PASSED [ 40%]
tests/test_openai_service.py::test_openai_service_parses_valid_response PASSED [ 41%]
tests/test_openai_service.py::test_openai_service_raises_on_invalid_json_output PASSED [ 42%]
tests/test_openai_service.py::test_openai_service_retries_then_succeeds PASSED [ 42%]
tests/test_parse.py::test_parse_diary_success PASSED                     [ 43%]
tests/test_parse.py::test_parse_diary_rejects_short_text PASSED          [ 43%]
tests/test_parse.py::test_parse_diary_request_schema_validation PASSED   [ 44%]
tests/test_parse.py::test_parse_diary_requires_auth PASSED               [ 44%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_01] PASSED [ 45%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_02] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_03] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_04] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_05] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_01] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_02] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_03] PASSED [ 49%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_04] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_05] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_01] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_02] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_03] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_04] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_05] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_01] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_02] PASSED [ 54%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_03] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_04] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_05] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_01] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_02] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_03] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_04] PASSED [ 58%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_05] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_01] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_02] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_03] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_04] PASSED [ 61%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_05] PASSED [ 61%]
tests/test_preferences_route.py::test_get_profile_returns_profile_with_job_family PASSED [ 62%]
tests/test_preferences_route.py::test_put_profile_updates_and_returns_profile PASSED [ 63%]
tests/test_preferences_route.py::test_put_profile_invalid_job_family_returns_422 PASSED [ 63%]
tests/test_preferences_route.py::test_delete_data_returns_ok_and_calls_supabase_delete PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[get-/api/preferences/profile-None] PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[put-/api/preferences/profile-payload1] PASSED [ 65%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[delete-/api/preferences/data-None] PASSED [ 65%]
tests/test_preferences_route.py::test_put_profile_deduplicates_trend_compare_by PASSED [ 66%]
tests/test_preferences_route.py::test_put_profile_falls_back_to_service_role_on_rls_error PASSED [ 67%]
tests/test_preferences_route.py::test_put_profile_returns_500_when_upsert_returns_empty_row PASSED [ 67%]
tests/test_reflect_route.py::test_reflect_happy_path_returns_question PASSED [ 68%]
tests/test_reflect_route.py::test_reflect_requires_auth PASSED           [ 68%]
tests/test_reflect_route.py::test_reflect_returns_429_when_daily_limit_exceeded PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_openai_failure_returns_502 PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_handles_empty_entries_gracefully PASSED [ 70%]
tests/test_reflect_route.py::test_reflect_rejects_missing_entries_field PASSED [ 71%]
tests/test_reflect_route.py::test_reflect_rejects_invalid_entries_type PASSED [ 71%]
tests/test_reports_route.py::test_reports_returns_existing_report PASSED [ 72%]
tests/test_reports_route.py::test_reports_returns_404_when_missing PASSED [ 72%]
tests/test_reports_route.py::test_reports_requires_auth PASSED           [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/logs-payload0] PASSED [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[get-/api/reports?date=2026-02-15-None] PASSED [ 74%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/analyze-payload2] PASSED [ 75%]
tests/test_security.py::test_expired_jwt_returns_401 PASSED              [ 75%]
tests/test_security.py::test_tampered_jwt_returns_401 PASSED             [ 76%]
tests/test_security.py::test_logs_get_scopes_queries_to_authenticated_user PASSED [ 76%]
tests/test_security.py::test_logs_post_forces_user_id_from_auth_context PASSED [ 77%]
tests/test_security.py::test_reports_get_scopes_queries_to_authenticated_user PASSED [ 77%]
tests/test_security.py::test_insights_weekly_scopes_queries_to_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_profile_get_scopes_by_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_delete_scopes_by_authenticated_user PASSED [ 79%]
tests/test_security.py::test_preferences_delete_removes_only_my_rows PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400 PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_replay_is_ignored PASSED     [ 81%]
tests/test_streaks_service.py::test_compute_streaks_returns_five_for_five_consecutive_days PASSED [ 81%]
tests/test_streaks_service.py::test_compute_streaks_resets_current_when_anchor_day_missing PASSED [ 82%]
tests/test_streaks_service.py::test_extract_log_dates_ignores_invalid_rows PASSED [ 82%]
tests/test_stripe_integration.py::test_stripe_status_returns_availability PASSED [ 83%]
tests/test_stripe_integration.py::test_stripe_status_requires_auth PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_happy_path PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_auth PASSED [ 85%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_email_identity PASSED [ 85%]
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription PASSED [ 86%]
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade PASSED [ 86%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature PASSED [ 87%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature PASSED [ 88%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature PASSED [ 88%]
tests/test_suggest_route.py::test_suggest_happy_path_returns_activity PASSED [ 89%]
tests/test_suggest_route.py::test_suggest_requires_auth PASSED           [ 89%]
tests/test_suggest_route.py::test_suggest_returns_429_when_daily_limit_exceeded PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_openai_failure_returns_502 PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_rejects_missing_required_fields PASSED [ 91%]
tests/test_suggest_route.py::test_suggest_accepts_null_context PASSED    [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_non_string_current_time PASSED [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_invalid_time_format PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_extracts_supabase_payload PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_uses_text_when_json_missing PASSED [ 94%]
tests/test_supabase_rest_service.py::test_select_wraps_single_object_as_list PASSED [ 94%]
tests/test_trends_route.py::test_trends_cohort_happy_path_includes_cohort_and_personal_metrics PASSED [ 95%]
tests/test_trends_route.py::test_trends_cohort_requires_auth PASSED      [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_disabled_when_opt_in_is_false PASSED [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_default_metrics_on_empty_rpc PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_unknown_query_params_do_not_break_response PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_uses_profile_filters_in_rpc_call PASSED [ 98%]
tests/test_usage_service.py::test_estimate_cost_usd_returns_value PASSED [ 98%]
tests/test_usage_service.py::test_count_daily_analyze_calls_counts_rows PASSED [ 99%]
tests/test_usage_service.py::test_insert_usage_event_fallbacks_when_service_conflict PASSED [100%]

=============================== warnings summary ===============================
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature
  /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/lib/python3.12/site-packages/httpx/_content.py:204: DeprecationWarning: Use 'content=<...>' to upload raw bytes/text content.
    warnings.warn(message, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 176 passed, 8 warnings in 0.90s ========================
[2026-02-16 00:44:34] PASS [api-pytest]
[2026-02-16 00:44:34] RUN [web-lint] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run lint

> lint
> next lint

âœ” No ESLint warnings or errors
[2026-02-16 00:44:35] PASS [web-lint]
[2026-02-16 00:44:35] RUN [web-typecheck] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run typecheck

> typecheck
> tsc --noEmit --incremental false

[2026-02-16 00:44:37] PASS [web-typecheck]
[2026-02-16 00:44:37] RUN [web-build] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run build

> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand

[2026-02-16 00:44:47] PASS [web-build]
[2026-02-16 00:44:47] RUN [web-e2e] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run test:e2e

> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  3 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.1s)
  âœ“  4 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.4s)
  âœ“  1 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.5s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (559ms)
  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.9s)
  âœ“  2 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (1.9s)

  6 passed (13.0s)
[2026-02-16 00:45:00] PASS [web-e2e]
[2026-02-16 00:45:00] RUN [release-verify] cd /Users/taeksoojung/Desktop/RutineIQ && ./scripts/release-verify.sh
[release-verify] G1 web checks

> lint
> next lint

âœ” No ESLint warnings or errors

> typecheck
> tsc --noEmit --incremental false


> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand


> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  2 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.1s)
  âœ“  3 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.5s)
  âœ“  1 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.5s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (628ms)
  âœ“  4 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.8s)
  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (2.0s)

  6 passed (14.1s)
[release-verify] G2 api checks
All checks passed!
All done! âœ¨ ðŸ° âœ¨
1 file would be left unchanged.
Success: no issues found in 1 source file
[release-verify] G3/G4 live smoke
[staging-smoke] stripe smoke fake mode enabled
[staging-smoke] clearing existing listeners on 8012
[staging-smoke] starting local api on 127.0.0.1:8012
[staging-smoke] live F2 e2e

> test:e2e:live
> E2E_MODE=live playwright test e2e/core-flows.spec.ts -g "F2"


Running 1 test using 1 worker

  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (22.4s)

  1 passed (33.0s)
[staging-smoke] api+db+stripe live smoke
LIVE_SMOKE_OK
[staging-smoke] PASS
[release-verify] PASS
[2026-02-16 00:46:42] PASS [release-verify]
[2026-02-16 00:46:42] --- Cycle 8 PASS ---
[2026-02-16 00:46:42] --- Cycle 9 start ---
[2026-02-16 00:46:42] Cycle 9 attempt 1
[2026-02-16 00:46:42] RUN [api-pytest] cd /Users/taeksoojung/Desktop/RutineIQ/apps/api && .venv/bin/python -m pytest tests/ -v --tb=short
============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-8.3.4, pluggy-1.6.0 -- /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/taeksoojung/Desktop/RutineIQ/apps/api
configfile: pytest.ini
plugins: anyio-4.12.1, respx-0.22.0, asyncio-0.25.2
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=function
collecting ... collected 176 items

tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_01] PASSED [  0%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_02] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_03] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_04] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_05] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_01] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_02] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_03] PASSED [  4%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_04] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_05] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_01] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_02] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_03] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_04] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_05] PASSED [  8%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_01] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_02] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_03] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_04] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_05] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_01] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_02] PASSED [ 12%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_03] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_04] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_05] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_01] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_02] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_03] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_04] PASSED [ 16%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_05] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[worker_ko-ko-entries0-False-3-True] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[student_en-en-entries1-False-3-False] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[low_activity-ko-entries2-False-1-True] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[day2_with_yesterday_plan-ko-entries3-True-2-True] PASSED [ 19%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[high_activity-en-entries4-False-4-False] PASSED [ 19%]
tests/test_analyze_route.py::test_analyze_success_returns_report PASSED  [ 20%]
tests/test_analyze_route.py::test_analyze_returns_429_on_rate_limit PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_openai_failure_returns_502 PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_requires_auth PASSED           [ 22%]
tests/test_analyze_route.py::test_analyze_allows_first_run_with_incomplete_profile PASSED [ 22%]
tests/test_analyze_route.py::test_analyze_tracks_schema_retry_in_quality_meta PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_signal_rich_quality_score_is_higher_than_signal_poor PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_low_signal_data_adds_conservative_guidance PASSED [ 24%]
tests/test_e2e_flows.py::test_new_user_full_flow_save_parse_save_analyze_report PASSED [ 25%]
tests/test_e2e_flows.py::test_returning_user_flow_reuses_cached_report PASSED [ 25%]
tests/test_e2e_flows.py::test_preferences_and_cohort_flow_uses_updated_profile_filters PASSED [ 26%]
tests/test_e2e_flows.py::test_multi_day_trend_flow_posts_7_days_and_returns_weekly_insights PASSED [ 26%]
tests/test_error_cases.py::test_parse_diary_empty_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_parse_diary_too_long_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_analyze_with_future_date_is_handled PASSED [ 28%]
tests/test_error_cases.py::test_analyze_with_old_date_is_handled PASSED  [ 28%]
tests/test_error_cases.py::test_parse_diary_malformed_openai_output_returns_502 PASSED [ 29%]
tests/test_error_cases.py::test_reflect_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_suggest_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_analyze_malformed_openai_output_returns_502 PASSED [ 31%]
tests/test_error_cases.py::test_analyze_supabase_select_failure_returns_502_or_500 PASSED [ 31%]
tests/test_error_cases.py::test_reflect_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_suggest_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_analyze_missing_activity_log_still_returns_report PASSED [ 33%]
tests/test_error_cases.py::test_rate_limit_isolated_between_two_users PASSED [ 34%]
tests/test_health.py::test_health_returns_ok PASSED                      [ 34%]
tests/test_insights_route.py::test_weekly_insights_includes_streak_and_trend PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_resets_current_streak_when_today_missing PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_rejects_date_window_over_31_days PASSED [ 36%]
tests/test_logs_route.py::test_post_logs_creates_entry PASSED            [ 36%]
tests/test_logs_route.py::test_post_logs_duplicate_date_uses_upsert_on_conflict PASSED [ 37%]
tests/test_logs_route.py::test_get_logs_returns_saved_log PASSED         [ 38%]
tests/test_logs_route.py::test_logs_requires_auth PASSED                 [ 38%]
tests/test_logs_route.py::test_post_logs_updates_profile_streak_metrics PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_ignores_missing_streak_columns_until_migration_applied PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_persists_optional_daily_meta PASSED [ 40%]
tests/test_logs_route.py::test_post_logs_accepts_optional_entry_confidence PASSED [ 40%]
tests/test_openai_service.py::test_openai_service_parses_valid_response PASSED [ 41%]
tests/test_openai_service.py::test_openai_service_raises_on_invalid_json_output PASSED [ 42%]
tests/test_openai_service.py::test_openai_service_retries_then_succeeds PASSED [ 42%]
tests/test_parse.py::test_parse_diary_success PASSED                     [ 43%]
tests/test_parse.py::test_parse_diary_rejects_short_text PASSED          [ 43%]
tests/test_parse.py::test_parse_diary_request_schema_validation PASSED   [ 44%]
tests/test_parse.py::test_parse_diary_requires_auth PASSED               [ 44%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_01] PASSED [ 45%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_02] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_03] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_04] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_05] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_01] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_02] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_03] PASSED [ 49%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_04] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_05] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_01] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_02] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_03] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_04] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_05] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_01] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_02] PASSED [ 54%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_03] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_04] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_05] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_01] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_02] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_03] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_04] PASSED [ 58%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_05] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_01] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_02] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_03] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_04] PASSED [ 61%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_05] PASSED [ 61%]
tests/test_preferences_route.py::test_get_profile_returns_profile_with_job_family PASSED [ 62%]
tests/test_preferences_route.py::test_put_profile_updates_and_returns_profile PASSED [ 63%]
tests/test_preferences_route.py::test_put_profile_invalid_job_family_returns_422 PASSED [ 63%]
tests/test_preferences_route.py::test_delete_data_returns_ok_and_calls_supabase_delete PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[get-/api/preferences/profile-None] PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[put-/api/preferences/profile-payload1] PASSED [ 65%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[delete-/api/preferences/data-None] PASSED [ 65%]
tests/test_preferences_route.py::test_put_profile_deduplicates_trend_compare_by PASSED [ 66%]
tests/test_preferences_route.py::test_put_profile_falls_back_to_service_role_on_rls_error PASSED [ 67%]
tests/test_preferences_route.py::test_put_profile_returns_500_when_upsert_returns_empty_row PASSED [ 67%]
tests/test_reflect_route.py::test_reflect_happy_path_returns_question PASSED [ 68%]
tests/test_reflect_route.py::test_reflect_requires_auth PASSED           [ 68%]
tests/test_reflect_route.py::test_reflect_returns_429_when_daily_limit_exceeded PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_openai_failure_returns_502 PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_handles_empty_entries_gracefully PASSED [ 70%]
tests/test_reflect_route.py::test_reflect_rejects_missing_entries_field PASSED [ 71%]
tests/test_reflect_route.py::test_reflect_rejects_invalid_entries_type PASSED [ 71%]
tests/test_reports_route.py::test_reports_returns_existing_report PASSED [ 72%]
tests/test_reports_route.py::test_reports_returns_404_when_missing PASSED [ 72%]
tests/test_reports_route.py::test_reports_requires_auth PASSED           [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/logs-payload0] PASSED [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[get-/api/reports?date=2026-02-15-None] PASSED [ 74%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/analyze-payload2] PASSED [ 75%]
tests/test_security.py::test_expired_jwt_returns_401 PASSED              [ 75%]
tests/test_security.py::test_tampered_jwt_returns_401 PASSED             [ 76%]
tests/test_security.py::test_logs_get_scopes_queries_to_authenticated_user PASSED [ 76%]
tests/test_security.py::test_logs_post_forces_user_id_from_auth_context PASSED [ 77%]
tests/test_security.py::test_reports_get_scopes_queries_to_authenticated_user PASSED [ 77%]
tests/test_security.py::test_insights_weekly_scopes_queries_to_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_profile_get_scopes_by_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_delete_scopes_by_authenticated_user PASSED [ 79%]
tests/test_security.py::test_preferences_delete_removes_only_my_rows PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400 PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_replay_is_ignored PASSED     [ 81%]
tests/test_streaks_service.py::test_compute_streaks_returns_five_for_five_consecutive_days PASSED [ 81%]
tests/test_streaks_service.py::test_compute_streaks_resets_current_when_anchor_day_missing PASSED [ 82%]
tests/test_streaks_service.py::test_extract_log_dates_ignores_invalid_rows PASSED [ 82%]
tests/test_stripe_integration.py::test_stripe_status_returns_availability PASSED [ 83%]
tests/test_stripe_integration.py::test_stripe_status_requires_auth PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_happy_path PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_auth PASSED [ 85%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_email_identity PASSED [ 85%]
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription PASSED [ 86%]
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade PASSED [ 86%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature PASSED [ 87%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature PASSED [ 88%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature PASSED [ 88%]
tests/test_suggest_route.py::test_suggest_happy_path_returns_activity PASSED [ 89%]
tests/test_suggest_route.py::test_suggest_requires_auth PASSED           [ 89%]
tests/test_suggest_route.py::test_suggest_returns_429_when_daily_limit_exceeded PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_openai_failure_returns_502 PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_rejects_missing_required_fields PASSED [ 91%]
tests/test_suggest_route.py::test_suggest_accepts_null_context PASSED    [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_non_string_current_time PASSED [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_invalid_time_format PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_extracts_supabase_payload PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_uses_text_when_json_missing PASSED [ 94%]
tests/test_supabase_rest_service.py::test_select_wraps_single_object_as_list PASSED [ 94%]
tests/test_trends_route.py::test_trends_cohort_happy_path_includes_cohort_and_personal_metrics PASSED [ 95%]
tests/test_trends_route.py::test_trends_cohort_requires_auth PASSED      [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_disabled_when_opt_in_is_false PASSED [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_default_metrics_on_empty_rpc PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_unknown_query_params_do_not_break_response PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_uses_profile_filters_in_rpc_call PASSED [ 98%]
tests/test_usage_service.py::test_estimate_cost_usd_returns_value PASSED [ 98%]
tests/test_usage_service.py::test_count_daily_analyze_calls_counts_rows PASSED [ 99%]
tests/test_usage_service.py::test_insert_usage_event_fallbacks_when_service_conflict PASSED [100%]

=============================== warnings summary ===============================
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature
  /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/lib/python3.12/site-packages/httpx/_content.py:204: DeprecationWarning: Use 'content=<...>' to upload raw bytes/text content.
    warnings.warn(message, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 176 passed, 8 warnings in 0.92s ========================
[2026-02-16 00:46:43] PASS [api-pytest]
[2026-02-16 00:46:43] RUN [web-lint] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run lint

> lint
> next lint

âœ” No ESLint warnings or errors
[2026-02-16 00:46:44] PASS [web-lint]
[2026-02-16 00:46:44] RUN [web-typecheck] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run typecheck

> typecheck
> tsc --noEmit --incremental false

[2026-02-16 00:46:46] PASS [web-typecheck]
[2026-02-16 00:46:46] RUN [web-build] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run build

> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand

[2026-02-16 00:46:54] PASS [web-build]
[2026-02-16 00:46:54] RUN [web-e2e] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run test:e2e

> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.2s)
  âœ“  5 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.5s)
  âœ“  4 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.5s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (557ms)
  âœ“  2 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (2.0s)
  âœ“  3 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (2.0s)

  6 passed (13.0s)
[2026-02-16 00:47:08] PASS [web-e2e]
[2026-02-16 00:47:08] RUN [release-verify] cd /Users/taeksoojung/Desktop/RutineIQ && ./scripts/release-verify.sh
[release-verify] G1 web checks

> lint
> next lint

âœ” No ESLint warnings or errors

> typecheck
> tsc --noEmit --incremental false


> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand


> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  2 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.1s)
  âœ“  1 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.3s)
  âœ“  4 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.3s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (551ms)
  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.7s)
  âœ“  3 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (1.9s)

  6 passed (12.9s)
[release-verify] G2 api checks
All checks passed!
All done! âœ¨ ðŸ° âœ¨
1 file would be left unchanged.
Success: no issues found in 1 source file
[release-verify] G3/G4 live smoke
[staging-smoke] stripe smoke fake mode enabled
[staging-smoke] clearing existing listeners on 8012
[staging-smoke] starting local api on 127.0.0.1:8012
[staging-smoke] live F2 e2e

> test:e2e:live
> E2E_MODE=live playwright test e2e/core-flows.spec.ts -g "F2"


Running 1 test using 1 worker

  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (20.7s)

  1 passed (31.2s)
[staging-smoke] api+db+stripe live smoke
LIVE_SMOKE_OK
[staging-smoke] PASS
[release-verify] PASS
[2026-02-16 00:48:37] PASS [release-verify]
[2026-02-16 00:48:37] --- Cycle 9 PASS ---
[2026-02-16 00:48:37] --- Cycle 10 start ---
[2026-02-16 00:48:37] Cycle 10 attempt 1
[2026-02-16 00:48:37] RUN [api-pytest] cd /Users/taeksoojung/Desktop/RutineIQ/apps/api && .venv/bin/python -m pytest tests/ -v --tb=short
============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-8.3.4, pluggy-1.6.0 -- /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/taeksoojung/Desktop/RutineIQ/apps/api
configfile: pytest.ini
plugins: anyio-4.12.1, respx-0.22.0, asyncio-0.25.2
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=function
collecting ... collected 176 items

tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_01] PASSED [  0%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_02] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_03] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_04] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_05] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_01] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_02] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_03] PASSED [  4%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_04] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_05] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_01] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_02] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_03] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_04] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_05] PASSED [  8%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_01] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_02] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_03] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_04] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_05] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_01] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_02] PASSED [ 12%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_03] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_04] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_05] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_01] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_02] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_03] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_04] PASSED [ 16%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_05] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[worker_ko-ko-entries0-False-3-True] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[student_en-en-entries1-False-3-False] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[low_activity-ko-entries2-False-1-True] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[day2_with_yesterday_plan-ko-entries3-True-2-True] PASSED [ 19%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[high_activity-en-entries4-False-4-False] PASSED [ 19%]
tests/test_analyze_route.py::test_analyze_success_returns_report PASSED  [ 20%]
tests/test_analyze_route.py::test_analyze_returns_429_on_rate_limit PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_openai_failure_returns_502 PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_requires_auth PASSED           [ 22%]
tests/test_analyze_route.py::test_analyze_allows_first_run_with_incomplete_profile PASSED [ 22%]
tests/test_analyze_route.py::test_analyze_tracks_schema_retry_in_quality_meta PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_signal_rich_quality_score_is_higher_than_signal_poor PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_low_signal_data_adds_conservative_guidance PASSED [ 24%]
tests/test_e2e_flows.py::test_new_user_full_flow_save_parse_save_analyze_report PASSED [ 25%]
tests/test_e2e_flows.py::test_returning_user_flow_reuses_cached_report PASSED [ 25%]
tests/test_e2e_flows.py::test_preferences_and_cohort_flow_uses_updated_profile_filters PASSED [ 26%]
tests/test_e2e_flows.py::test_multi_day_trend_flow_posts_7_days_and_returns_weekly_insights PASSED [ 26%]
tests/test_error_cases.py::test_parse_diary_empty_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_parse_diary_too_long_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_analyze_with_future_date_is_handled PASSED [ 28%]
tests/test_error_cases.py::test_analyze_with_old_date_is_handled PASSED  [ 28%]
tests/test_error_cases.py::test_parse_diary_malformed_openai_output_returns_502 PASSED [ 29%]
tests/test_error_cases.py::test_reflect_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_suggest_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_analyze_malformed_openai_output_returns_502 PASSED [ 31%]
tests/test_error_cases.py::test_analyze_supabase_select_failure_returns_502_or_500 PASSED [ 31%]
tests/test_error_cases.py::test_reflect_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_suggest_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_analyze_missing_activity_log_still_returns_report PASSED [ 33%]
tests/test_error_cases.py::test_rate_limit_isolated_between_two_users PASSED [ 34%]
tests/test_health.py::test_health_returns_ok PASSED                      [ 34%]
tests/test_insights_route.py::test_weekly_insights_includes_streak_and_trend PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_resets_current_streak_when_today_missing PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_rejects_date_window_over_31_days PASSED [ 36%]
tests/test_logs_route.py::test_post_logs_creates_entry PASSED            [ 36%]
tests/test_logs_route.py::test_post_logs_duplicate_date_uses_upsert_on_conflict PASSED [ 37%]
tests/test_logs_route.py::test_get_logs_returns_saved_log PASSED         [ 38%]
tests/test_logs_route.py::test_logs_requires_auth PASSED                 [ 38%]
tests/test_logs_route.py::test_post_logs_updates_profile_streak_metrics PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_ignores_missing_streak_columns_until_migration_applied PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_persists_optional_daily_meta PASSED [ 40%]
tests/test_logs_route.py::test_post_logs_accepts_optional_entry_confidence PASSED [ 40%]
tests/test_openai_service.py::test_openai_service_parses_valid_response PASSED [ 41%]
tests/test_openai_service.py::test_openai_service_raises_on_invalid_json_output PASSED [ 42%]
tests/test_openai_service.py::test_openai_service_retries_then_succeeds PASSED [ 42%]
tests/test_parse.py::test_parse_diary_success PASSED                     [ 43%]
tests/test_parse.py::test_parse_diary_rejects_short_text PASSED          [ 43%]
tests/test_parse.py::test_parse_diary_request_schema_validation PASSED   [ 44%]
tests/test_parse.py::test_parse_diary_requires_auth PASSED               [ 44%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_01] PASSED [ 45%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_02] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_03] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_04] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_05] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_01] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_02] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_03] PASSED [ 49%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_04] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_05] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_01] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_02] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_03] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_04] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_05] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_01] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_02] PASSED [ 54%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_03] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_04] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_05] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_01] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_02] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_03] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_04] PASSED [ 58%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_05] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_01] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_02] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_03] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_04] PASSED [ 61%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_05] PASSED [ 61%]
tests/test_preferences_route.py::test_get_profile_returns_profile_with_job_family PASSED [ 62%]
tests/test_preferences_route.py::test_put_profile_updates_and_returns_profile PASSED [ 63%]
tests/test_preferences_route.py::test_put_profile_invalid_job_family_returns_422 PASSED [ 63%]
tests/test_preferences_route.py::test_delete_data_returns_ok_and_calls_supabase_delete PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[get-/api/preferences/profile-None] PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[put-/api/preferences/profile-payload1] PASSED [ 65%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[delete-/api/preferences/data-None] PASSED [ 65%]
tests/test_preferences_route.py::test_put_profile_deduplicates_trend_compare_by PASSED [ 66%]
tests/test_preferences_route.py::test_put_profile_falls_back_to_service_role_on_rls_error PASSED [ 67%]
tests/test_preferences_route.py::test_put_profile_returns_500_when_upsert_returns_empty_row PASSED [ 67%]
tests/test_reflect_route.py::test_reflect_happy_path_returns_question PASSED [ 68%]
tests/test_reflect_route.py::test_reflect_requires_auth PASSED           [ 68%]
tests/test_reflect_route.py::test_reflect_returns_429_when_daily_limit_exceeded PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_openai_failure_returns_502 PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_handles_empty_entries_gracefully PASSED [ 70%]
tests/test_reflect_route.py::test_reflect_rejects_missing_entries_field PASSED [ 71%]
tests/test_reflect_route.py::test_reflect_rejects_invalid_entries_type PASSED [ 71%]
tests/test_reports_route.py::test_reports_returns_existing_report PASSED [ 72%]
tests/test_reports_route.py::test_reports_returns_404_when_missing PASSED [ 72%]
tests/test_reports_route.py::test_reports_requires_auth PASSED           [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/logs-payload0] PASSED [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[get-/api/reports?date=2026-02-15-None] PASSED [ 74%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/analyze-payload2] PASSED [ 75%]
tests/test_security.py::test_expired_jwt_returns_401 PASSED              [ 75%]
tests/test_security.py::test_tampered_jwt_returns_401 PASSED             [ 76%]
tests/test_security.py::test_logs_get_scopes_queries_to_authenticated_user PASSED [ 76%]
tests/test_security.py::test_logs_post_forces_user_id_from_auth_context PASSED [ 77%]
tests/test_security.py::test_reports_get_scopes_queries_to_authenticated_user PASSED [ 77%]
tests/test_security.py::test_insights_weekly_scopes_queries_to_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_profile_get_scopes_by_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_delete_scopes_by_authenticated_user PASSED [ 79%]
tests/test_security.py::test_preferences_delete_removes_only_my_rows PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400 PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_replay_is_ignored PASSED     [ 81%]
tests/test_streaks_service.py::test_compute_streaks_returns_five_for_five_consecutive_days PASSED [ 81%]
tests/test_streaks_service.py::test_compute_streaks_resets_current_when_anchor_day_missing PASSED [ 82%]
tests/test_streaks_service.py::test_extract_log_dates_ignores_invalid_rows PASSED [ 82%]
tests/test_stripe_integration.py::test_stripe_status_returns_availability PASSED [ 83%]
tests/test_stripe_integration.py::test_stripe_status_requires_auth PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_happy_path PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_auth PASSED [ 85%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_email_identity PASSED [ 85%]
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription PASSED [ 86%]
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade PASSED [ 86%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature PASSED [ 87%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature PASSED [ 88%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature PASSED [ 88%]
tests/test_suggest_route.py::test_suggest_happy_path_returns_activity PASSED [ 89%]
tests/test_suggest_route.py::test_suggest_requires_auth PASSED           [ 89%]
tests/test_suggest_route.py::test_suggest_returns_429_when_daily_limit_exceeded PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_openai_failure_returns_502 PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_rejects_missing_required_fields PASSED [ 91%]
tests/test_suggest_route.py::test_suggest_accepts_null_context PASSED    [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_non_string_current_time PASSED [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_invalid_time_format PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_extracts_supabase_payload PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_uses_text_when_json_missing PASSED [ 94%]
tests/test_supabase_rest_service.py::test_select_wraps_single_object_as_list PASSED [ 94%]
tests/test_trends_route.py::test_trends_cohort_happy_path_includes_cohort_and_personal_metrics PASSED [ 95%]
tests/test_trends_route.py::test_trends_cohort_requires_auth PASSED      [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_disabled_when_opt_in_is_false PASSED [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_default_metrics_on_empty_rpc PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_unknown_query_params_do_not_break_response PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_uses_profile_filters_in_rpc_call PASSED [ 98%]
tests/test_usage_service.py::test_estimate_cost_usd_returns_value PASSED [ 98%]
tests/test_usage_service.py::test_count_daily_analyze_calls_counts_rows PASSED [ 99%]
tests/test_usage_service.py::test_insert_usage_event_fallbacks_when_service_conflict PASSED [100%]

=============================== warnings summary ===============================
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature
  /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/lib/python3.12/site-packages/httpx/_content.py:204: DeprecationWarning: Use 'content=<...>' to upload raw bytes/text content.
    warnings.warn(message, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 176 passed, 8 warnings in 1.62s ========================
[2026-02-16 00:48:39] PASS [api-pytest]
[2026-02-16 00:48:39] RUN [web-lint] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run lint

> lint
> next lint

âœ” No ESLint warnings or errors
[2026-02-16 00:48:40] PASS [web-lint]
[2026-02-16 00:48:40] RUN [web-typecheck] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run typecheck

> typecheck
> tsc --noEmit --incremental false

[2026-02-16 00:48:42] PASS [web-typecheck]
[2026-02-16 00:48:42] RUN [web-build] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run build

> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand

[2026-02-16 00:48:51] PASS [web-build]
[2026-02-16 00:48:51] RUN [web-e2e] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run test:e2e

> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  4 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.1s)
  âœ“  1 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.5s)
  âœ“  3 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.5s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (621ms)
  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.8s)
  âœ“  2 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (1.9s)

  6 passed (13.1s)
[2026-02-16 00:49:05] PASS [web-e2e]
[2026-02-16 00:49:05] RUN [release-verify] cd /Users/taeksoojung/Desktop/RutineIQ && ./scripts/release-verify.sh
[release-verify] G1 web checks

> lint
> next lint

âœ” No ESLint warnings or errors

> typecheck
> tsc --noEmit --incremental false


> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand


> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  3 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (987ms)
  âœ“  2 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.5s)
  âœ“  1 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.5s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (635ms)
  âœ“  4 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.9s)
  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (1.9s)

  6 passed (12.9s)
[release-verify] G2 api checks
All checks passed!
All done! âœ¨ ðŸ° âœ¨
1 file would be left unchanged.
Success: no issues found in 1 source file
[release-verify] G3/G4 live smoke
[staging-smoke] stripe smoke fake mode enabled
[staging-smoke] clearing existing listeners on 8012
[staging-smoke] starting local api on 127.0.0.1:8012
[staging-smoke] live F2 e2e

> test:e2e:live
> E2E_MODE=live playwright test e2e/core-flows.spec.ts -g "F2"


Running 1 test using 1 worker

  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (17.9s)

  1 passed (28.7s)
[staging-smoke] api+db+stripe live smoke
LIVE_SMOKE_OK
[staging-smoke] PASS
[release-verify] PASS
[2026-02-16 00:50:29] PASS [release-verify]
[2026-02-16 00:50:29] --- Cycle 10 PASS ---
[2026-02-16 00:50:29] === Batch 2/10 (Cycle 11-20) ===
[2026-02-16 00:50:29] --- Cycle 11 start ---
[2026-02-16 00:50:29] Cycle 11 attempt 1
[2026-02-16 00:50:29] RUN [api-pytest] cd /Users/taeksoojung/Desktop/RutineIQ/apps/api && .venv/bin/python -m pytest tests/ -v --tb=short
============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-8.3.4, pluggy-1.6.0 -- /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/taeksoojung/Desktop/RutineIQ/apps/api
configfile: pytest.ini
plugins: anyio-4.12.1, respx-0.22.0, asyncio-0.25.2
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=function
collecting ... collected 176 items

tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_01] PASSED [  0%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_02] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_03] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_04] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_05] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_01] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_02] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_03] PASSED [  4%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_04] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_05] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_01] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_02] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_03] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_04] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_05] PASSED [  8%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_01] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_02] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_03] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_04] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_05] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_01] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_02] PASSED [ 12%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_03] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_04] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_05] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_01] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_02] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_03] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_04] PASSED [ 16%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_05] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[worker_ko-ko-entries0-False-3-True] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[student_en-en-entries1-False-3-False] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[low_activity-ko-entries2-False-1-True] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[day2_with_yesterday_plan-ko-entries3-True-2-True] PASSED [ 19%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[high_activity-en-entries4-False-4-False] PASSED [ 19%]
tests/test_analyze_route.py::test_analyze_success_returns_report PASSED  [ 20%]
tests/test_analyze_route.py::test_analyze_returns_429_on_rate_limit PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_openai_failure_returns_502 PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_requires_auth PASSED           [ 22%]
tests/test_analyze_route.py::test_analyze_allows_first_run_with_incomplete_profile PASSED [ 22%]
tests/test_analyze_route.py::test_analyze_tracks_schema_retry_in_quality_meta PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_signal_rich_quality_score_is_higher_than_signal_poor PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_low_signal_data_adds_conservative_guidance PASSED [ 24%]
tests/test_e2e_flows.py::test_new_user_full_flow_save_parse_save_analyze_report PASSED [ 25%]
tests/test_e2e_flows.py::test_returning_user_flow_reuses_cached_report PASSED [ 25%]
tests/test_e2e_flows.py::test_preferences_and_cohort_flow_uses_updated_profile_filters PASSED [ 26%]
tests/test_e2e_flows.py::test_multi_day_trend_flow_posts_7_days_and_returns_weekly_insights PASSED [ 26%]
tests/test_error_cases.py::test_parse_diary_empty_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_parse_diary_too_long_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_analyze_with_future_date_is_handled PASSED [ 28%]
tests/test_error_cases.py::test_analyze_with_old_date_is_handled PASSED  [ 28%]
tests/test_error_cases.py::test_parse_diary_malformed_openai_output_returns_502 PASSED [ 29%]
tests/test_error_cases.py::test_reflect_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_suggest_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_analyze_malformed_openai_output_returns_502 PASSED [ 31%]
tests/test_error_cases.py::test_analyze_supabase_select_failure_returns_502_or_500 PASSED [ 31%]
tests/test_error_cases.py::test_reflect_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_suggest_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_analyze_missing_activity_log_still_returns_report PASSED [ 33%]
tests/test_error_cases.py::test_rate_limit_isolated_between_two_users PASSED [ 34%]
tests/test_health.py::test_health_returns_ok PASSED                      [ 34%]
tests/test_insights_route.py::test_weekly_insights_includes_streak_and_trend PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_resets_current_streak_when_today_missing PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_rejects_date_window_over_31_days PASSED [ 36%]
tests/test_logs_route.py::test_post_logs_creates_entry PASSED            [ 36%]
tests/test_logs_route.py::test_post_logs_duplicate_date_uses_upsert_on_conflict PASSED [ 37%]
tests/test_logs_route.py::test_get_logs_returns_saved_log PASSED         [ 38%]
tests/test_logs_route.py::test_logs_requires_auth PASSED                 [ 38%]
tests/test_logs_route.py::test_post_logs_updates_profile_streak_metrics PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_ignores_missing_streak_columns_until_migration_applied PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_persists_optional_daily_meta PASSED [ 40%]
tests/test_logs_route.py::test_post_logs_accepts_optional_entry_confidence PASSED [ 40%]
tests/test_openai_service.py::test_openai_service_parses_valid_response PASSED [ 41%]
tests/test_openai_service.py::test_openai_service_raises_on_invalid_json_output PASSED [ 42%]
tests/test_openai_service.py::test_openai_service_retries_then_succeeds PASSED [ 42%]
tests/test_parse.py::test_parse_diary_success PASSED                     [ 43%]
tests/test_parse.py::test_parse_diary_rejects_short_text PASSED          [ 43%]
tests/test_parse.py::test_parse_diary_request_schema_validation PASSED   [ 44%]
tests/test_parse.py::test_parse_diary_requires_auth PASSED               [ 44%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_01] PASSED [ 45%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_02] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_03] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_04] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_05] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_01] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_02] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_03] PASSED [ 49%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_04] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_05] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_01] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_02] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_03] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_04] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_05] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_01] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_02] PASSED [ 54%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_03] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_04] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_05] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_01] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_02] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_03] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_04] PASSED [ 58%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_05] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_01] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_02] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_03] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_04] PASSED [ 61%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_05] PASSED [ 61%]
tests/test_preferences_route.py::test_get_profile_returns_profile_with_job_family PASSED [ 62%]
tests/test_preferences_route.py::test_put_profile_updates_and_returns_profile PASSED [ 63%]
tests/test_preferences_route.py::test_put_profile_invalid_job_family_returns_422 PASSED [ 63%]
tests/test_preferences_route.py::test_delete_data_returns_ok_and_calls_supabase_delete PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[get-/api/preferences/profile-None] PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[put-/api/preferences/profile-payload1] PASSED [ 65%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[delete-/api/preferences/data-None] PASSED [ 65%]
tests/test_preferences_route.py::test_put_profile_deduplicates_trend_compare_by PASSED [ 66%]
tests/test_preferences_route.py::test_put_profile_falls_back_to_service_role_on_rls_error PASSED [ 67%]
tests/test_preferences_route.py::test_put_profile_returns_500_when_upsert_returns_empty_row PASSED [ 67%]
tests/test_reflect_route.py::test_reflect_happy_path_returns_question PASSED [ 68%]
tests/test_reflect_route.py::test_reflect_requires_auth PASSED           [ 68%]
tests/test_reflect_route.py::test_reflect_returns_429_when_daily_limit_exceeded PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_openai_failure_returns_502 PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_handles_empty_entries_gracefully PASSED [ 70%]
tests/test_reflect_route.py::test_reflect_rejects_missing_entries_field PASSED [ 71%]
tests/test_reflect_route.py::test_reflect_rejects_invalid_entries_type PASSED [ 71%]
tests/test_reports_route.py::test_reports_returns_existing_report PASSED [ 72%]
tests/test_reports_route.py::test_reports_returns_404_when_missing PASSED [ 72%]
tests/test_reports_route.py::test_reports_requires_auth PASSED           [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/logs-payload0] PASSED [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[get-/api/reports?date=2026-02-15-None] PASSED [ 74%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/analyze-payload2] PASSED [ 75%]
tests/test_security.py::test_expired_jwt_returns_401 PASSED              [ 75%]
tests/test_security.py::test_tampered_jwt_returns_401 PASSED             [ 76%]
tests/test_security.py::test_logs_get_scopes_queries_to_authenticated_user PASSED [ 76%]
tests/test_security.py::test_logs_post_forces_user_id_from_auth_context PASSED [ 77%]
tests/test_security.py::test_reports_get_scopes_queries_to_authenticated_user PASSED [ 77%]
tests/test_security.py::test_insights_weekly_scopes_queries_to_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_profile_get_scopes_by_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_delete_scopes_by_authenticated_user PASSED [ 79%]
tests/test_security.py::test_preferences_delete_removes_only_my_rows PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400 PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_replay_is_ignored PASSED     [ 81%]
tests/test_streaks_service.py::test_compute_streaks_returns_five_for_five_consecutive_days PASSED [ 81%]
tests/test_streaks_service.py::test_compute_streaks_resets_current_when_anchor_day_missing PASSED [ 82%]
tests/test_streaks_service.py::test_extract_log_dates_ignores_invalid_rows PASSED [ 82%]
tests/test_stripe_integration.py::test_stripe_status_returns_availability PASSED [ 83%]
tests/test_stripe_integration.py::test_stripe_status_requires_auth PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_happy_path PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_auth PASSED [ 85%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_email_identity PASSED [ 85%]
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription PASSED [ 86%]
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade PASSED [ 86%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature PASSED [ 87%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature PASSED [ 88%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature PASSED [ 88%]
tests/test_suggest_route.py::test_suggest_happy_path_returns_activity PASSED [ 89%]
tests/test_suggest_route.py::test_suggest_requires_auth PASSED           [ 89%]
tests/test_suggest_route.py::test_suggest_returns_429_when_daily_limit_exceeded PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_openai_failure_returns_502 PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_rejects_missing_required_fields PASSED [ 91%]
tests/test_suggest_route.py::test_suggest_accepts_null_context PASSED    [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_non_string_current_time PASSED [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_invalid_time_format PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_extracts_supabase_payload PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_uses_text_when_json_missing PASSED [ 94%]
tests/test_supabase_rest_service.py::test_select_wraps_single_object_as_list PASSED [ 94%]
tests/test_trends_route.py::test_trends_cohort_happy_path_includes_cohort_and_personal_metrics PASSED [ 95%]
tests/test_trends_route.py::test_trends_cohort_requires_auth PASSED      [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_disabled_when_opt_in_is_false PASSED [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_default_metrics_on_empty_rpc PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_unknown_query_params_do_not_break_response PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_uses_profile_filters_in_rpc_call PASSED [ 98%]
tests/test_usage_service.py::test_estimate_cost_usd_returns_value PASSED [ 98%]
tests/test_usage_service.py::test_count_daily_analyze_calls_counts_rows PASSED [ 99%]
tests/test_usage_service.py::test_insert_usage_event_fallbacks_when_service_conflict PASSED [100%]

=============================== warnings summary ===============================
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature
  /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/lib/python3.12/site-packages/httpx/_content.py:204: DeprecationWarning: Use 'content=<...>' to upload raw bytes/text content.
    warnings.warn(message, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 176 passed, 8 warnings in 1.36s ========================
[2026-02-16 00:50:31] PASS [api-pytest]
[2026-02-16 00:50:31] RUN [web-lint] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run lint

> lint
> next lint

âœ” No ESLint warnings or errors
[2026-02-16 00:50:32] PASS [web-lint]
[2026-02-16 00:50:32] RUN [web-typecheck] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run typecheck

> typecheck
> tsc --noEmit --incremental false

[2026-02-16 00:50:34] PASS [web-typecheck]
[2026-02-16 00:50:34] RUN [web-build] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run build

> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand

[2026-02-16 00:50:43] PASS [web-build]
[2026-02-16 00:50:43] RUN [web-e2e] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run test:e2e

> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  2 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.1s)
  âœ“  4 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.3s)
  âœ“  1 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.4s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (522ms)
  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.8s)
  âœ“  3 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (2.0s)

  6 passed (12.1s)
[2026-02-16 00:50:56] PASS [web-e2e]
[2026-02-16 00:50:56] RUN [release-verify] cd /Users/taeksoojung/Desktop/RutineIQ && ./scripts/release-verify.sh
[release-verify] G1 web checks

> lint
> next lint

âœ” No ESLint warnings or errors

> typecheck
> tsc --noEmit --incremental false


> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand


> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  2 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.1s)
  âœ“  5 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.6s)
  âœ“  3 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.6s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (652ms)
  âœ“  4 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.8s)
  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (2.0s)

  6 passed (11.9s)
[release-verify] G2 api checks
All checks passed!
All done! âœ¨ ðŸ° âœ¨
1 file would be left unchanged.
Success: no issues found in 1 source file
[release-verify] G3/G4 live smoke
[staging-smoke] stripe smoke fake mode enabled
[staging-smoke] clearing existing listeners on 8012
[staging-smoke] starting local api on 127.0.0.1:8012
[staging-smoke] live F2 e2e

> test:e2e:live
> E2E_MODE=live playwright test e2e/core-flows.spec.ts -g "F2"


Running 1 test using 1 worker

  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (23.4s)

  1 passed (33.0s)
[staging-smoke] api+db+stripe live smoke
LIVE_SMOKE_OK
[staging-smoke] PASS
[release-verify] PASS
[2026-02-16 00:52:27] PASS [release-verify]
[2026-02-16 00:52:27] --- Cycle 11 PASS ---
[2026-02-16 00:52:27] --- Cycle 12 start ---
[2026-02-16 00:52:27] Cycle 12 attempt 1
[2026-02-16 00:52:27] RUN [api-pytest] cd /Users/taeksoojung/Desktop/RutineIQ/apps/api && .venv/bin/python -m pytest tests/ -v --tb=short
============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-8.3.4, pluggy-1.6.0 -- /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/taeksoojung/Desktop/RutineIQ/apps/api
configfile: pytest.ini
plugins: anyio-4.12.1, respx-0.22.0, asyncio-0.25.2
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=function
collecting ... collected 176 items

tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_01] PASSED [  0%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_02] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_03] PASSED [  1%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_en_04] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_office_ko_05] PASSED [  2%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_01] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_02] PASSED [  3%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_03] PASSED [  4%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_en_04] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_freelance_ko_05] PASSED [  5%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_01] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_02] PASSED [  6%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_03] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_en_04] PASSED [  7%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_student_ko_05] PASSED [  8%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_01] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_02] PASSED [  9%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_03] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_en_04] PASSED [ 10%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_burnout_ko_05] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_01] PASSED [ 11%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_02] PASSED [ 12%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_03] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_en_04] PASSED [ 13%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_recovery_ko_05] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_01] PASSED [ 14%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_02] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_03] PASSED [ 15%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_en_04] PASSED [ 16%]
tests/test_analyze_eval.py::test_analyze_eval_scenarios[analyze_sparse_ko_05] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[worker_ko-ko-entries0-False-3-True] PASSED [ 17%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[student_en-en-entries1-False-3-False] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[low_activity-ko-entries2-False-1-True] PASSED [ 18%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[day2_with_yesterday_plan-ko-entries3-True-2-True] PASSED [ 19%]
tests/test_analyze_quality_scenarios.py::test_analyze_quality_scenarios[high_activity-en-entries4-False-4-False] PASSED [ 19%]
tests/test_analyze_route.py::test_analyze_success_returns_report PASSED  [ 20%]
tests/test_analyze_route.py::test_analyze_returns_429_on_rate_limit PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_openai_failure_returns_502 PASSED [ 21%]
tests/test_analyze_route.py::test_analyze_requires_auth PASSED           [ 22%]
tests/test_analyze_route.py::test_analyze_allows_first_run_with_incomplete_profile PASSED [ 22%]
tests/test_analyze_route.py::test_analyze_tracks_schema_retry_in_quality_meta PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_signal_rich_quality_score_is_higher_than_signal_poor PASSED [ 23%]
tests/test_analyze_route.py::test_analyze_low_signal_data_adds_conservative_guidance PASSED [ 24%]
tests/test_e2e_flows.py::test_new_user_full_flow_save_parse_save_analyze_report PASSED [ 25%]
tests/test_e2e_flows.py::test_returning_user_flow_reuses_cached_report PASSED [ 25%]
tests/test_e2e_flows.py::test_preferences_and_cohort_flow_uses_updated_profile_filters PASSED [ 26%]
tests/test_e2e_flows.py::test_multi_day_trend_flow_posts_7_days_and_returns_weekly_insights PASSED [ 26%]
tests/test_error_cases.py::test_parse_diary_empty_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_parse_diary_too_long_text_returns_422 PASSED [ 27%]
tests/test_error_cases.py::test_analyze_with_future_date_is_handled PASSED [ 28%]
tests/test_error_cases.py::test_analyze_with_old_date_is_handled PASSED  [ 28%]
tests/test_error_cases.py::test_parse_diary_malformed_openai_output_returns_502 PASSED [ 29%]
tests/test_error_cases.py::test_reflect_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_suggest_malformed_openai_output_returns_502 PASSED [ 30%]
tests/test_error_cases.py::test_analyze_malformed_openai_output_returns_502 PASSED [ 31%]
tests/test_error_cases.py::test_analyze_supabase_select_failure_returns_502_or_500 PASSED [ 31%]
tests/test_error_cases.py::test_reflect_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_suggest_usage_backend_failure_returns_500 PASSED [ 32%]
tests/test_error_cases.py::test_analyze_missing_activity_log_still_returns_report PASSED [ 33%]
tests/test_error_cases.py::test_rate_limit_isolated_between_two_users PASSED [ 34%]
tests/test_health.py::test_health_returns_ok PASSED                      [ 34%]
tests/test_insights_route.py::test_weekly_insights_includes_streak_and_trend PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_resets_current_streak_when_today_missing PASSED [ 35%]
tests/test_insights_route.py::test_weekly_insights_rejects_date_window_over_31_days PASSED [ 36%]
tests/test_logs_route.py::test_post_logs_creates_entry PASSED            [ 36%]
tests/test_logs_route.py::test_post_logs_duplicate_date_uses_upsert_on_conflict PASSED [ 37%]
tests/test_logs_route.py::test_get_logs_returns_saved_log PASSED         [ 38%]
tests/test_logs_route.py::test_logs_requires_auth PASSED                 [ 38%]
tests/test_logs_route.py::test_post_logs_updates_profile_streak_metrics PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_ignores_missing_streak_columns_until_migration_applied PASSED [ 39%]
tests/test_logs_route.py::test_post_logs_persists_optional_daily_meta PASSED [ 40%]
tests/test_logs_route.py::test_post_logs_accepts_optional_entry_confidence PASSED [ 40%]
tests/test_openai_service.py::test_openai_service_parses_valid_response PASSED [ 41%]
tests/test_openai_service.py::test_openai_service_raises_on_invalid_json_output PASSED [ 42%]
tests/test_openai_service.py::test_openai_service_retries_then_succeeds PASSED [ 42%]
tests/test_parse.py::test_parse_diary_success PASSED                     [ 43%]
tests/test_parse.py::test_parse_diary_rejects_short_text PASSED          [ 43%]
tests/test_parse.py::test_parse_diary_request_schema_validation PASSED   [ 44%]
tests/test_parse.py::test_parse_diary_requires_auth PASSED               [ 44%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_01] PASSED [ 45%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_02] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_03] PASSED [ 46%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_04] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_ko_basic_05] PASSED [ 47%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_01] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_02] PASSED [ 48%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_03] PASSED [ 49%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_04] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_en_basic_05] PASSED [ 50%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_01] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_02] PASSED [ 51%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_03] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_en_04] PASSED [ 52%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_notime_ko_05] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_01] PASSED [ 53%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_02] PASSED [ 54%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_03] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_en_04] PASSED [ 55%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_mood_ko_05] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_01] PASSED [ 56%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_02] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_03] PASSED [ 57%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_en_04] PASSED [ 58%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_dense_ko_05] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_01] PASSED [ 59%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_02] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_03] PASSED [ 60%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_en_04] PASSED [ 61%]
tests/test_parse_diary_eval.py::test_parse_diary_eval_scenarios[parse_min_ko_05] PASSED [ 61%]
tests/test_preferences_route.py::test_get_profile_returns_profile_with_job_family PASSED [ 62%]
tests/test_preferences_route.py::test_put_profile_updates_and_returns_profile PASSED [ 63%]
tests/test_preferences_route.py::test_put_profile_invalid_job_family_returns_422 PASSED [ 63%]
tests/test_preferences_route.py::test_delete_data_returns_ok_and_calls_supabase_delete PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[get-/api/preferences/profile-None] PASSED [ 64%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[put-/api/preferences/profile-payload1] PASSED [ 65%]
tests/test_preferences_route.py::test_preferences_endpoints_require_auth[delete-/api/preferences/data-None] PASSED [ 65%]
tests/test_preferences_route.py::test_put_profile_deduplicates_trend_compare_by PASSED [ 66%]
tests/test_preferences_route.py::test_put_profile_falls_back_to_service_role_on_rls_error PASSED [ 67%]
tests/test_preferences_route.py::test_put_profile_returns_500_when_upsert_returns_empty_row PASSED [ 67%]
tests/test_reflect_route.py::test_reflect_happy_path_returns_question PASSED [ 68%]
tests/test_reflect_route.py::test_reflect_requires_auth PASSED           [ 68%]
tests/test_reflect_route.py::test_reflect_returns_429_when_daily_limit_exceeded PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_openai_failure_returns_502 PASSED [ 69%]
tests/test_reflect_route.py::test_reflect_handles_empty_entries_gracefully PASSED [ 70%]
tests/test_reflect_route.py::test_reflect_rejects_missing_entries_field PASSED [ 71%]
tests/test_reflect_route.py::test_reflect_rejects_invalid_entries_type PASSED [ 71%]
tests/test_reports_route.py::test_reports_returns_existing_report PASSED [ 72%]
tests/test_reports_route.py::test_reports_returns_404_when_missing PASSED [ 72%]
tests/test_reports_route.py::test_reports_requires_auth PASSED           [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/logs-payload0] PASSED [ 73%]
tests/test_security.py::test_protected_endpoints_require_auth[get-/api/reports?date=2026-02-15-None] PASSED [ 74%]
tests/test_security.py::test_protected_endpoints_require_auth[post-/api/analyze-payload2] PASSED [ 75%]
tests/test_security.py::test_expired_jwt_returns_401 PASSED              [ 75%]
tests/test_security.py::test_tampered_jwt_returns_401 PASSED             [ 76%]
tests/test_security.py::test_logs_get_scopes_queries_to_authenticated_user PASSED [ 76%]
tests/test_security.py::test_logs_post_forces_user_id_from_auth_context PASSED [ 77%]
tests/test_security.py::test_reports_get_scopes_queries_to_authenticated_user PASSED [ 77%]
tests/test_security.py::test_insights_weekly_scopes_queries_to_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_profile_get_scopes_by_authenticated_user PASSED [ 78%]
tests/test_security.py::test_preferences_delete_scopes_by_authenticated_user PASSED [ 79%]
tests/test_security.py::test_preferences_delete_removes_only_my_rows PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400 PASSED [ 80%]
tests/test_security.py::test_stripe_webhook_replay_is_ignored PASSED     [ 81%]
tests/test_streaks_service.py::test_compute_streaks_returns_five_for_five_consecutive_days PASSED [ 81%]
tests/test_streaks_service.py::test_compute_streaks_resets_current_when_anchor_day_missing PASSED [ 82%]
tests/test_streaks_service.py::test_extract_log_dates_ignores_invalid_rows PASSED [ 82%]
tests/test_stripe_integration.py::test_stripe_status_returns_availability PASSED [ 83%]
tests/test_stripe_integration.py::test_stripe_status_requires_auth PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_happy_path PASSED [ 84%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_auth PASSED [ 85%]
tests/test_stripe_integration.py::test_create_checkout_session_requires_email_identity PASSED [ 85%]
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription PASSED [ 86%]
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade PASSED [ 86%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature PASSED [ 87%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature PASSED [ 88%]
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature PASSED [ 88%]
tests/test_suggest_route.py::test_suggest_happy_path_returns_activity PASSED [ 89%]
tests/test_suggest_route.py::test_suggest_requires_auth PASSED           [ 89%]
tests/test_suggest_route.py::test_suggest_returns_429_when_daily_limit_exceeded PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_openai_failure_returns_502 PASSED [ 90%]
tests/test_suggest_route.py::test_suggest_rejects_missing_required_fields PASSED [ 91%]
tests/test_suggest_route.py::test_suggest_accepts_null_context PASSED    [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_non_string_current_time PASSED [ 92%]
tests/test_suggest_route.py::test_suggest_rejects_invalid_time_format PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_extracts_supabase_payload PASSED [ 93%]
tests/test_supabase_rest_service.py::test_raise_for_error_uses_text_when_json_missing PASSED [ 94%]
tests/test_supabase_rest_service.py::test_select_wraps_single_object_as_list PASSED [ 94%]
tests/test_trends_route.py::test_trends_cohort_happy_path_includes_cohort_and_personal_metrics PASSED [ 95%]
tests/test_trends_route.py::test_trends_cohort_requires_auth PASSED      [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_disabled_when_opt_in_is_false PASSED [ 96%]
tests/test_trends_route.py::test_trends_cohort_returns_default_metrics_on_empty_rpc PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_unknown_query_params_do_not_break_response PASSED [ 97%]
tests/test_trends_route.py::test_trends_cohort_uses_profile_filters_in_rpc_call PASSED [ 98%]
tests/test_usage_service.py::test_estimate_cost_usd_returns_value PASSED [ 98%]
tests/test_usage_service.py::test_count_daily_analyze_calls_counts_rows PASSED [ 99%]
tests/test_usage_service.py::test_insert_usage_event_fallbacks_when_service_conflict PASSED [100%]

=============================== warnings summary ===============================
tests/test_security.py::test_stripe_webhook_invalid_signature_returns_400
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_security.py::test_stripe_webhook_replay_is_ignored
tests/test_stripe_integration.py::test_webhook_checkout_completed_updates_subscription
tests/test_stripe_integration.py::test_webhook_subscription_deleted_triggers_downgrade
tests/test_stripe_webhook_route.py::test_stripe_webhook_accepts_valid_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_missing_signature
tests/test_stripe_webhook_route.py::test_stripe_webhook_rejects_invalid_signature
  /Users/taeksoojung/Desktop/RutineIQ/apps/api/.venv/lib/python3.12/site-packages/httpx/_content.py:204: DeprecationWarning: Use 'content=<...>' to upload raw bytes/text content.
    warnings.warn(message, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 176 passed, 8 warnings in 1.77s ========================
[2026-02-16 00:52:30] PASS [api-pytest]
[2026-02-16 00:52:30] RUN [web-lint] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run lint

> lint
> next lint

âœ” No ESLint warnings or errors
[2026-02-16 00:52:31] PASS [web-lint]
[2026-02-16 00:52:31] RUN [web-typecheck] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run typecheck

> typecheck
> tsc --noEmit --incremental false

[2026-02-16 00:52:32] PASS [web-typecheck]
[2026-02-16 00:52:32] RUN [web-build] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run build

> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand

[2026-02-16 00:52:41] PASS [web-build]
[2026-02-16 00:52:41] RUN [web-e2e] cd /Users/taeksoojung/Desktop/RutineIQ/apps/web && npm run test:e2e

> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  2 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.1s)
  âœ“  1 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.5s)
  âœ“  4 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.5s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (557ms)
  âœ“  3 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (1.8s)
  âœ“  5 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (1.9s)

  6 passed (12.0s)
[2026-02-16 00:52:54] PASS [web-e2e]
[2026-02-16 00:52:54] RUN [release-verify] cd /Users/taeksoojung/Desktop/RutineIQ && ./scripts/release-verify.sh
[release-verify] G1 web checks

> lint
> next lint

âœ” No ESLint warnings or errors

> typecheck
> tsc --noEmit --incremental false


> build
> npm run env:check && node scripts/clean-next.mjs && next build


> env:check
> node scripts/check-env.mjs

[env-check] OK
  â–² Next.js 14.2.35
  - Environments: .env.local

   Creating an optimized production build ...
 âœ“ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/21) ...
   Generating static pages (5/21) 
   Generating static pages (10/21) 
   Generating static pages (15/21) 
 âœ“ Generating static pages (21/21)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
â”Œ â—‹ /                                    11.6 kB         108 kB
â”œ â—‹ /_not-found                          151 B          87.8 kB
â”œ Æ’ /admin                               6.37 kB         156 kB
â”œ Æ’ /app                                 151 B          87.8 kB
â”œ Æ’ /app/billing                         6.16 kB         156 kB
â”œ Æ’ /app/daily-flow                      15 kB           164 kB
â”œ Æ’ /app/insights                        15 kB           173 kB
â”œ Æ’ /app/preferences                     10.3 kB         160 kB
â”œ Æ’ /app/reports                         151 B          87.8 kB
â”œ Æ’ /app/reports/[date]                  11.9 kB         161 kB
â”œ Æ’ /auth/callback                       0 B                0 B
â”œ Æ’ /auth/token                          0 B                0 B
â”œ â—‹ /icon                                0 B                0 B
â”œ â—‹ /login                               7.75 kB         166 kB
â”œ â—‹ /manifest.webmanifest                0 B                0 B
â”œ â—‹ /offline                             151 B          87.8 kB
â”œ â—‹ /opengraph-image                     0 B                0 B
â”œ â—‹ /reset-password                      3.45 kB         153 kB
â”œ â—‹ /robots.txt                          0 B                0 B
â”” â—‹ /sitemap.xml                         0 B                0 B
+ First Load JS shared by all            87.6 kB
  â”œ chunks/117-0a1c9166a7a57909.js       31.9 kB
  â”œ chunks/fd9d1056-c5fa278d705b6443.js  53.6 kB
  â”” other shared chunks (total)          2.09 kB


â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand


> test:e2e
> playwright test


Running 6 tests using 5 workers

  âœ“  3 [chromium] â€º e2e/core-flows.spec.ts:218:7 â€º RutineIQ core flows â€º F1: core app shell loads to insights (1.2s)
  âœ“  2 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on tablet (1.8s)
  âœ“  5 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on mobile (1.8s)
  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:282:7 â€º RutineIQ core flows â€º F3: Guest billing conversion -> checkout session request (2.0s)
  âœ“  6 [chromium] â€º e2e/responsive-layouts.spec.ts:18:7 â€º responsive layout is stable on desktop (812ms)
  âœ“  4 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (2.1s)

  6 passed (13.1s)
[release-verify] G2 api checks
All checks passed!
All done! âœ¨ ðŸ° âœ¨
1 file would be left unchanged.
Success: no issues found in 1 source file
[release-verify] G3/G4 live smoke
[staging-smoke] stripe smoke fake mode enabled
[staging-smoke] clearing existing listeners on 8012
[staging-smoke] starting local api on 127.0.0.1:8012
[staging-smoke] live F2 e2e

> test:e2e:live
> E2E_MODE=live playwright test e2e/core-flows.spec.ts -g "F2"


Running 1 test using 1 worker

  âœ“  1 [chromium] â€º e2e/core-flows.spec.ts:234:7 â€º RutineIQ core flows â€º F2: Daily Flow save -> analyze -> report render (18.7s)

  1 passed (29.5s)
[staging-smoke] api+db+stripe live smoke
LIVE_SMOKE_OK
[staging-smoke] PASS
[release-verify] PASS
